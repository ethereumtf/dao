"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ae=require("@stablelib/chacha20poly1305"),dn=require("@stablelib/hkdf"),ce=require("@stablelib/random"),z=require("@stablelib/sha256"),ln=require("@stablelib/x25519"),d=require("uint8arrays"),pn=require("detect-browser"),C=require("@walletconnect/time"),w=require("@walletconnect/window-getters"),fn=require("@walletconnect/window-metadata"),mn=require("query-string"),yn=require("@walletconnect/relay-api");function ue(e){if(e&&e.__esModule)return e;var n=Object.create(null);return e&&Object.keys(e).forEach(function(t){if(t!=="default"){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}}),n.default=e,Object.freeze(n)}var de=ue(ln),D=ue(mn);const $=":";function le(e){const[n,t]=e.split($);return{namespace:n,reference:t}}function pe(e){const{namespace:n,reference:t}=e;return[n,t].join($)}function Y(e){const[n,t,r]=e.split($);return{namespace:n,reference:t,address:r}}function fe(e){const{namespace:n,reference:t,address:r}=e;return[n,t,r].join($)}function G(e,n){const t=[];return e.forEach(r=>{const s=n(r);t.includes(s)||t.push(s)}),t}function me(e){const{address:n}=Y(e);return n}function ye(e){const{namespace:n,reference:t}=Y(e);return pe({namespace:n,reference:t})}function gn(e,n){const{namespace:t,reference:r}=le(n);return fe({namespace:t,reference:r,address:e})}function En(e){return G(e,me)}function ge(e){return G(e,ye)}function hn(e,n=[]){const t=[];return Object.keys(e).forEach(r=>{if(n.length&&!n.includes(r))return;const s=e[r];t.push(...s.accounts)}),t}function vn(e,n=[]){const t=[];return Object.keys(e).forEach(r=>{if(n.length&&!n.includes(r))return;const s=e[r];t.push(...ge(s.accounts))}),t}function Nn(e,n=[]){const t=[];return Object.keys(e).forEach(r=>{if(n.length&&!n.includes(r))return;const s=e[r];t.push(...M(r,s))}),t}function M(e,n){return e.includes(":")?[e]:n.chains||[]}const K=e=>e?.split(":"),Ee=e=>{const n=e&&K(e);if(n)return n[3]},bn=e=>{const n=e&&K(e);if(n)return n[2]+":"+n[3]},he=e=>{const n=e&&K(e);if(n)return n.pop()},On=(e,n)=>{const t=`${e.domain} wants you to sign in with your Ethereum account:`,r=he(n),s=e.statement,o=`URI: ${e.aud}`,i=`Version: ${e.version}`,l=`Chain ID: ${Ee(n)}`,p=`Nonce: ${e.nonce}`,a=`Issued At: ${e.iat}`,u=e.resources&&e.resources.length>0?`Resources:
${e.resources.map(c=>`- ${c}`).join(`
`)}`:void 0;return[t,r,"",s,"",o,i,l,p,a,u].filter(c=>c!=null).join(`
`)},W="base10",f="base16",k="base64pad",q="utf8",J=0,_=1,Sn=0,ve=1,Q=12,Z=32;function An(){const e=de.generateKeyPair();return{privateKey:d.toString(e.secretKey,f),publicKey:d.toString(e.publicKey,f)}}function Tn(){const e=ce.randomBytes(Z);return d.toString(e,f)}function Pn(e,n){const t=de.sharedKey(d.fromString(e,f),d.fromString(n,f)),r=new dn.HKDF(z.SHA256,t).expand(Z);return d.toString(r,f)}function In(e){const n=z.hash(d.fromString(e,f));return d.toString(n,f)}function Rn(e){const n=z.hash(d.fromString(e,q));return d.toString(n,f)}function Ne(e){return d.fromString(`${e}`,W)}function V(e){return Number(d.toString(e,W))}function Cn(e){const n=Ne(typeof e.type<"u"?e.type:J);if(V(n)===_&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof e.senderPublicKey<"u"?d.fromString(e.senderPublicKey,f):void 0,r=typeof e.iv<"u"?d.fromString(e.iv,f):ce.randomBytes(Q),s=new ae.ChaCha20Poly1305(d.fromString(e.symKey,f)).seal(r,d.fromString(e.message,q));return be({type:n,sealed:s,iv:r,senderPublicKey:t})}function _n(e){const n=new ae.ChaCha20Poly1305(d.fromString(e.symKey,f)),{sealed:t,iv:r}=X(e.encoded),s=n.open(r,t);if(s===null)throw new Error("Failed to decrypt");return d.toString(s,q)}function be(e){if(V(e.type)===_){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return d.toString(d.concat([e.type,e.senderPublicKey,e.iv,e.sealed]),k)}return d.toString(d.concat([e.type,e.iv,e.sealed]),k)}function X(e){const n=d.fromString(e,k),t=n.slice(Sn,ve),r=ve;if(V(t)===_){const l=r+Z,p=l+Q,a=n.slice(r,l),u=n.slice(l,p),c=n.slice(p);return{type:t,sealed:c,iv:u,senderPublicKey:a}}const s=r+Q,o=n.slice(r,s),i=n.slice(s);return{type:t,sealed:i,iv:o}}function Un(e,n){const t=X(e);return Oe({type:V(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?d.toString(t.senderPublicKey,f):void 0,receiverPublicKey:n?.receiverPublicKey})}function Oe(e){const n=e?.type||J;if(n===_){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:n,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function wn(e){return e.type===_&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}var Vn=Object.defineProperty,Se=Object.getOwnPropertySymbols,jn=Object.prototype.hasOwnProperty,Dn=Object.prototype.propertyIsEnumerable,Ae=(e,n,t)=>n in e?Vn(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Te=(e,n)=>{for(var t in n||(n={}))jn.call(n,t)&&Ae(e,t,n[t]);if(Se)for(var t of Se(n))Dn.call(n,t)&&Ae(e,t,n[t]);return e};const Pe="ReactNative",N={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},L=" ",$n=":",Ie="/",ee=2,Mn=1e3,Re="js";function ne(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ce(){return!w.getDocument()&&!!w.getNavigator()&&navigator.product===Pe}function _e(){return!ne()&&!!w.getNavigator()}function F(){return Ce()?N.reactNative:ne()?N.node:_e()?N.browser:N.unknown}function Ue(e,n){let t=D.parse(e);return t=Te(Te({},t),n),e=D.stringify(t),e}function Kn(){return fn.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function kn(e,n){var t;const r=F(),s={protocol:e,version:n,env:r};return r==="browser"&&(s.host=((t=w.getLocation())==null?void 0:t.host)||"unknown"),s}function we(){if(typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:r}=global.Platform;return[t,r].join("-")}const e=pn.detect();if(e===null)return"unknown";const n=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[n,e.name,e.version].join("-"):[n,e.version].join("-")}function Ve(){var e;const n=F();return n===N.browser?[n,((e=w.getLocation())==null?void 0:e.host)||"unknown"].join(":"):n}function je(e,n,t){const r=we(),s=Ve();return[[e,n].join("-"),[Re,t].join("-"),r,s].join("/")}function qn({protocol:e,version:n,relayUrl:t,sdkVersion:r,auth:s,projectId:o,useOnCloseEvent:i}){const l=t.split("?"),p=je(e,n,r),a={auth:s,ua:p,projectId:o,useOnCloseEvent:i||void 0},u=Ue(l[1]||"",a);return l[0]+"?"+u}function Ln(e){let n=(e.match(/^[^:]+(?=:\/\/)/gi)||[])[0];const t=typeof n<"u"?e.split("://")[1]:e;return n=n==="wss"?"https":"http",[n,t].join("://")}function Fn(e,n,t){if(!e[n]||typeof e[n]!==t)throw new Error(`Missing or invalid "${n}" param`)}function De(e,n=ee){return $e(e.split(Ie),n)}function xn(e){return De(e).join(L)}function b(e,n){return e.filter(t=>n.includes(t)).length===e.length}function $e(e,n=ee){return e.slice(Math.max(e.length-n,0))}function Hn(e){return Object.fromEntries(e.entries())}function Bn(e){return new Map(Object.entries(e))}function zn(e,n){const t={};return Object.keys(e).forEach(r=>{t[r]=n(e[r])}),t}const Yn=e=>e;function Me(e){return e.trim().replace(/^\w/,n=>n.toUpperCase())}function Gn(e){return e.split(L).map(n=>Me(n)).join(L)}function Wn(e=C.FIVE_MINUTES,n){const t=C.toMiliseconds(e||C.FIVE_MINUTES);let r,s,o;return{resolve:i=>{o&&r&&(clearTimeout(o),r(i))},reject:i=>{o&&s&&(clearTimeout(o),s(i))},done:()=>new Promise((i,l)=>{o=setTimeout(()=>{l(new Error(n))},t),r=i,s=l})}}function Jn(e,n,t){return new Promise(async(r,s)=>{const o=setTimeout(()=>s(new Error(t)),n);try{const i=await e;r(i)}catch(i){s(i)}clearTimeout(o)})}function te(e,n){if(typeof n=="string"&&n.startsWith(`${e}:`))return n;if(e.toLowerCase()==="topic"){if(typeof n!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${n}`}else if(e.toLowerCase()==="id"){if(typeof n!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${n}`}throw new Error(`Unknown expirer target type: ${e}`)}function Qn(e){return te("topic",e)}function Zn(e){return te("id",e)}function Xn(e){const[n,t]=e.split(":"),r={id:void 0,topic:void 0};if(n==="topic"&&typeof t=="string")r.topic=t;else if(n==="id"&&Number.isInteger(Number(t)))r.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${n}:${t}`);return r}function et(e,n){return C.fromMiliseconds((n||Date.now())+C.toMiliseconds(e))}function nt(e){return Date.now()>=C.toMiliseconds(e)}function tt(e,n){return`${e}${n?`:${n}`:""}`}function O(e=[],n=[]){return[...new Set([...e,...n])]}async function rt({id:e,topic:n,wcDeepLink:t}){try{if(!t)return;const r=typeof t=="string"?JSON.parse(t):t;let s=r?.href;if(typeof s!="string")return;s.endsWith("/")&&(s=s.slice(0,-1));const o=`${s}/wc?requestId=${e}&sessionTopic=${n}`,i=F();i===N.browser?window.open(o,"_self","noreferrer noopener"):i===N.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(r){console.error(r)}}const Ke="irn";function st(e){return e?.relay||{protocol:Ke}}function ot(e){const n=yn.RELAY_JSONRPC[e];if(typeof n>"u")throw new Error(`Relay Protocol not supported: ${e}`);return n}var it=Object.defineProperty,ke=Object.getOwnPropertySymbols,at=Object.prototype.hasOwnProperty,ct=Object.prototype.propertyIsEnumerable,qe=(e,n,t)=>n in e?it(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,ut=(e,n)=>{for(var t in n||(n={}))at.call(n,t)&&qe(e,t,n[t]);if(ke)for(var t of ke(n))ct.call(n,t)&&qe(e,t,n[t]);return e};function Le(e,n="-"){const t={},r="relay"+n;return Object.keys(e).forEach(s=>{if(s.startsWith(r)){const o=s.replace(r,""),i=e[s];t[o]=i}}),t}function dt(e){const n=e.indexOf(":"),t=e.indexOf("?")!==-1?e.indexOf("?"):void 0,r=e.substring(0,n),s=e.substring(n+1,t).split("@"),o=typeof t<"u"?e.substring(t):"",i=D.parse(o);return{protocol:r,topic:Fe(s[0]),version:parseInt(s[1],10),symKey:i.symKey,relay:Le(i)}}function Fe(e){return e.startsWith("//")?e.substring(2):e}function xe(e,n="-"){const t="relay",r={};return Object.keys(e).forEach(s=>{const o=t+n+s;e[s]&&(r[o]=e[s])}),r}function lt(e){return`${e.protocol}:${e.topic}@${e.version}?`+D.stringify(ut({symKey:e.symKey},xe(e.relay)))}var pt=Object.defineProperty,ft=Object.defineProperties,mt=Object.getOwnPropertyDescriptors,He=Object.getOwnPropertySymbols,yt=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable,Be=(e,n,t)=>n in e?pt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Et=(e,n)=>{for(var t in n||(n={}))yt.call(n,t)&&Be(e,t,n[t]);if(He)for(var t of He(n))gt.call(n,t)&&Be(e,t,n[t]);return e},ht=(e,n)=>ft(e,mt(n));function P(e){const n=[];return e.forEach(t=>{const[r,s]=t.split(":");n.push(`${r}:${s}`)}),n}function ze(e){const n=[];return Object.values(e).forEach(t=>{n.push(...P(t.accounts))}),n}function Ye(e,n){const t=[];return Object.values(e).forEach(r=>{P(r.accounts).includes(n)&&t.push(...r.methods)}),t}function Ge(e,n){const t=[];return Object.values(e).forEach(r=>{P(r.accounts).includes(n)&&t.push(...r.events)}),t}function vt(e,n){const t=tn(e,n);if(t)throw new Error(t.message);const r={};for(const[s,o]of Object.entries(e))r[s]={methods:o.methods,events:o.events,chains:o.accounts.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)};return r}function Nt(e){const{proposal:{requiredNamespaces:n,optionalNamespaces:t={}},supportedNamespaces:r}=e,s=se(n),o=se(t),i={};Object.keys(r).forEach(a=>{const u=r[a].chains,c=r[a].methods,h=r[a].events,R=r[a].accounts;i[a]={chains:u,methods:c,events:h,accounts:R}});const l=sn(n,i,"approve()");if(l)throw new Error(l.message);const p={};return Object.keys(s).forEach(a=>{const u=r[a].chains.filter(E=>{var m,g;return(g=(m=s[a])==null?void 0:m.chains)==null?void 0:g.includes(E)}),c=r[a].methods.filter(E=>{var m,g;return(g=(m=s[a])==null?void 0:m.methods)==null?void 0:g.includes(E)}),h=r[a].events.filter(E=>{var m,g;return(g=(m=s[a])==null?void 0:m.events)==null?void 0:g.includes(E)}),R=u.map(E=>r[a].accounts.filter(m=>m.includes(`${E}:`))).flat();p[a]={chains:u,methods:c,events:h,accounts:R}}),Object.keys(o).forEach(a=>{var u,c,h,R,E,m;if(!r[a])return;const g=(c=(u=o[a])==null?void 0:u.chains)==null?void 0:c.filter(A=>r[a].chains.includes(A)),an=r[a].methods.filter(A=>{var T,U;return(U=(T=o[a])==null?void 0:T.methods)==null?void 0:U.includes(A)}),cn=r[a].events.filter(A=>{var T,U;return(U=(T=o[a])==null?void 0:T.events)==null?void 0:U.includes(A)}),un=g?.map(A=>r[a].accounts.filter(T=>T.includes(A))).flat();p[a]={chains:O((h=p[a])==null?void 0:h.chains,g),methods:O((R=p[a])==null?void 0:R.methods,an),events:O((E=p[a])==null?void 0:E.events,cn),accounts:O((m=p[a])==null?void 0:m.accounts,un)}}),p}function re(e){return e.includes(":")}function We(e){return re(e)?e.split(":")[0]:e}function se(e){var n,t,r;const s={};if(!x(e))return s;for(const[o,i]of Object.entries(e)){const l=re(o)?[o]:i.chains,p=i.methods||[],a=i.events||[],u=We(o);s[u]=ht(Et({},s[u]),{chains:O(l,(n=s[u])==null?void 0:n.chains),methods:O(p,(t=s[u])==null?void 0:t.methods),events:O(a,(r=s[u])==null?void 0:r.events)})}return s}const bt={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ot={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function v(e,n){const{message:t,code:r}=Ot[e];return{message:n?`${t} ${n}`:t,code:r}}function I(e,n){const{message:t,code:r}=bt[e];return{message:n?`${t} ${n}`:t,code:r}}function j(e,n){return Array.isArray(e)?typeof n<"u"&&e.length?e.every(n):!0:!1}function x(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function S(e){return typeof e>"u"}function y(e,n){return n&&S(e)?!0:typeof e=="string"&&!!e.trim().length}function H(e,n){return n&&S(e)?!0:typeof e=="number"&&!isNaN(e)}function St(e,n){const{requiredNamespaces:t}=n,r=Object.keys(e.namespaces),s=Object.keys(t);let o=!0;return b(s,r)?(r.forEach(i=>{const{accounts:l,methods:p,events:a}=e.namespaces[i],u=P(l),c=t[i];(!b(M(i,c),u)||!b(c.methods,p)||!b(c.events,a))&&(o=!1)}),o):!1}function B(e){return y(e,!1)&&e.includes(":")?e.split(":").length===2:!1}function Je(e){if(y(e,!1)&&e.includes(":")){const n=e.split(":");if(n.length===3){const t=n[0]+":"+n[1];return!!n[2]&&B(t)}}return!1}function At(e){if(y(e,!1))try{return typeof new URL(e)<"u"}catch{return!1}return!1}function Tt(e){var n;return(n=e?.proposer)==null?void 0:n.publicKey}function Pt(e){return e?.topic}function It(e,n){let t=null;return y(e?.publicKey,!1)||(t=v("MISSING_OR_INVALID",`${n} controller public key should be a string`)),t}function oe(e){let n=!0;return j(e)?e.length&&(n=e.every(t=>y(t,!1))):n=!1,n}function Qe(e,n,t){let r=null;return j(n)?n.forEach(s=>{r||(!B(s)||!s.includes(e))&&(r=I("UNSUPPORTED_CHAINS",`${t}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):r=I("UNSUPPORTED_CHAINS",`${t}, chains ${n} should be an array of strings conforming to "namespace:chainId" format`),r}function Ze(e,n){let t=null;return Object.entries(e).forEach(([r,s])=>{if(t)return;const o=Qe(r,M(r,s),`${n} requiredNamespace`);o&&(t=o)}),t}function Xe(e,n){let t=null;return j(e)?e.forEach(r=>{t||Je(r)||(t=I("UNSUPPORTED_ACCOUNTS",`${n}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):t=I("UNSUPPORTED_ACCOUNTS",`${n}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function en(e,n){let t=null;return Object.values(e).forEach(r=>{if(t)return;const s=Xe(r?.accounts,`${n} namespace`);s&&(t=s)}),t}function nn(e,n){let t=null;return oe(e?.methods)?oe(e?.events)||(t=I("UNSUPPORTED_EVENTS",`${n}, events should be an array of strings or empty array for no events`)):t=I("UNSUPPORTED_METHODS",`${n}, methods should be an array of strings or empty array for no methods`),t}function ie(e,n){let t=null;return Object.values(e).forEach(r=>{if(t)return;const s=nn(r,`${n}, namespace`);s&&(t=s)}),t}function Rt(e,n,t){let r=null;if(e&&x(e)){const s=ie(e,n);s&&(r=s);const o=Ze(e,n);o&&(r=o)}else r=v("MISSING_OR_INVALID",`${n}, ${t} should be an object with data`);return r}function tn(e,n){let t=null;if(e&&x(e)){const r=ie(e,n);r&&(t=r);const s=en(e,n);s&&(t=s)}else t=v("MISSING_OR_INVALID",`${n}, namespaces should be an object with data`);return t}function rn(e){return y(e.protocol,!0)}function Ct(e,n){let t=!1;return n&&!e?t=!0:e&&j(e)&&e.length&&e.forEach(r=>{t=rn(r)}),t}function _t(e){return typeof e=="number"}function Ut(e){return typeof e<"u"&&typeof e!==null}function wt(e){return!(!e||typeof e!="object"||!e.code||!H(e.code,!1)||!e.message||!y(e.message,!1))}function Vt(e){return!(S(e)||!y(e.method,!1))}function jt(e){return!(S(e)||S(e.result)&&S(e.error)||!H(e.id,!1)||!y(e.jsonrpc,!1))}function Dt(e){return!(S(e)||!y(e.name,!1))}function $t(e,n){return!(!B(n)||!ze(e).includes(n))}function Mt(e,n,t){return y(t,!1)?Ye(e,n).includes(t):!1}function Kt(e,n,t){return y(t,!1)?Ge(e,n).includes(t):!1}function sn(e,n,t){let r=null;const s=kt(e),o=qt(n),i=Object.keys(s),l=Object.keys(o),p=on(Object.keys(e)),a=on(Object.keys(n)),u=p.filter(c=>!a.includes(c));return u.length&&(r=v("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(n).toString()}`)),b(i,l)||(r=v("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${i.toString()}
      Approved: ${l.toString()}`)),Object.keys(n).forEach(c=>{if(!c.includes(":")||r)return;const h=P(n[c].accounts);h.includes(c)||(r=v("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${c}
        Required: ${c}
        Approved: ${h.toString()}`))}),i.forEach(c=>{r||(b(s[c].methods,o[c].methods)?b(s[c].events,o[c].events)||(r=v("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${c}`)):r=v("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${c}`))}),r}function kt(e){const n={};return Object.keys(e).forEach(t=>{var r;t.includes(":")?n[t]=e[t]:(r=e[t].chains)==null||r.forEach(s=>{n[s]={methods:e[t].methods,events:e[t].events}})}),n}function on(e){return[...new Set(e.map(n=>n.includes(":")?n.split(":")[0]:n))]}function qt(e){const n={};return Object.keys(e).forEach(t=>{if(t.includes(":"))n[t]=e[t];else{const r=P(e[t].accounts);r?.forEach(s=>{n[s]={accounts:e[t].accounts.filter(o=>o.includes(`${s}:`)),methods:e[t].methods,events:e[t].events}})}}),n}function Lt(e,n){return H(e,!1)&&e<=n.max&&e>=n.min}exports.BASE10=W,exports.BASE16=f,exports.BASE64=k,exports.COLON=$n,exports.DEFAULT_DEPTH=ee,exports.EMPTY_SPACE=L,exports.ENV_MAP=N,exports.ONE_THOUSAND=Mn,exports.REACT_NATIVE_PRODUCT=Pe,exports.RELAYER_DEFAULT_PROTOCOL=Ke,exports.SDK_TYPE=Re,exports.SLASH=Ie,exports.TYPE_0=J,exports.TYPE_1=_,exports.UTF8=q,exports.appendToQueryString=Ue,exports.assertType=Fn,exports.buildApprovedNamespaces=Nt,exports.calcExpiry=et,exports.capitalize=Gn,exports.capitalizeWord=Me,exports.createDelayedPromise=Wn,exports.createExpiringPromise=Jn,exports.decodeTypeByte=V,exports.decrypt=_n,exports.deriveSymKey=Pn,exports.deserialize=X,exports.encodeTypeByte=Ne,exports.encrypt=Cn,exports.engineEvent=tt,exports.enumify=Yn,exports.formatAccountId=fe,exports.formatAccountWithChain=gn,exports.formatChainId=pe,exports.formatExpirerTarget=te,exports.formatIdTarget=Zn,exports.formatMessage=On,exports.formatMessageContext=xn,exports.formatRelayParams=xe,exports.formatRelayRpcUrl=qn,exports.formatTopicTarget=Qn,exports.formatUA=je,exports.formatUri=lt,exports.generateKeyPair=An,exports.generateRandomBytes32=Tn,exports.getAccountsChains=P,exports.getAccountsFromNamespaces=hn,exports.getAddressFromAccount=me,exports.getAddressesFromAccounts=En,exports.getAppMetadata=Kn,exports.getChainFromAccount=ye,exports.getChainsFromAccounts=ge,exports.getChainsFromNamespace=M,exports.getChainsFromNamespaces=vn,exports.getChainsFromRequiredNamespaces=Nn,exports.getDidAddress=he,exports.getDidAddressSegments=K,exports.getDidChainId=Ee,exports.getEnvironment=F,exports.getHttpUrl=Ln,exports.getInternalError=v,exports.getJavascriptID=Ve,exports.getJavascriptOS=we,exports.getLastItems=$e,exports.getNamespacedDidChainId=bn,exports.getNamespacesChains=ze,exports.getNamespacesEventsForChainId=Ge,exports.getNamespacesMethodsForChainId=Ye,exports.getRelayClientMetadata=kn,exports.getRelayProtocolApi=ot,exports.getRelayProtocolName=st,exports.getRequiredNamespacesFromNamespaces=vt,exports.getSdkError=I,exports.getUniqueValues=G,exports.handleDeeplinkRedirect=rt,exports.hasOverlap=b,exports.hashKey=In,exports.hashMessage=Rn,exports.isBrowser=_e,exports.isCaipNamespace=re,exports.isConformingNamespaces=sn,exports.isExpired=nt,exports.isNode=ne,exports.isProposalStruct=Tt,exports.isReactNative=Ce,exports.isSessionCompatible=St,exports.isSessionStruct=Pt,exports.isTypeOneEnvelope=wn,exports.isUndefined=S,exports.isValidAccountId=Je,exports.isValidAccounts=Xe,exports.isValidActions=nn,exports.isValidArray=j,exports.isValidChainId=B,exports.isValidChains=Qe,exports.isValidController=It,exports.isValidErrorReason=wt,exports.isValidEvent=Dt,exports.isValidId=_t,exports.isValidNamespaceAccounts=en,exports.isValidNamespaceActions=ie,exports.isValidNamespaceChains=Ze,exports.isValidNamespaceMethodsOrEvents=oe,exports.isValidNamespaces=tn,exports.isValidNamespacesChainId=$t,exports.isValidNamespacesEvent=Kt,exports.isValidNamespacesRequest=Mt,exports.isValidNumber=H,exports.isValidObject=x,exports.isValidParams=Ut,exports.isValidRelay=rn,exports.isValidRelays=Ct,exports.isValidRequest=Vt,exports.isValidRequestExpiry=Lt,exports.isValidRequiredNamespaces=Rt,exports.isValidResponse=jt,exports.isValidString=y,exports.isValidUrl=At,exports.mapEntries=zn,exports.mapToObj=Hn,exports.mergeArrays=O,exports.normalizeNamespaces=se,exports.objToMap=Bn,exports.parseAccountId=Y,exports.parseChainId=le,exports.parseContextNames=De,exports.parseExpirerTarget=Xn,exports.parseNamespaceKey=We,exports.parseRelayParams=Le,exports.parseTopic=Fe,exports.parseUri=dt,exports.serialize=be,exports.validateDecoding=Un,exports.validateEncoding=Oe;
//# sourceMappingURL=index.cjs.js.map
