(function(k,Je){typeof exports=="object"&&typeof module<"u"?Je(exports):typeof define=="function"&&define.amd?define(["exports"],Je):(k=typeof globalThis<"u"?globalThis:k||self,Je(k["@walletconnect/core"]={}))})(this,function(k){"use strict";var Je=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var ut={exports:{}},Bt=typeof Reflect=="object"?Reflect:null,si=Bt&&typeof Bt.apply=="function"?Bt.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Er;Bt&&typeof Bt.ownKeys=="function"?Er=Bt.ownKeys:Object.getOwnPropertySymbols?Er=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Er=function(e){return Object.getOwnPropertyNames(e)};function Ia(t){console&&console.warn&&console.warn(t)}var oi=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}ut.exports=Oe,ut.exports.once=Pa,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var ai=10;function wr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return ai},set:function(t){if(typeof t!="number"||t<0||oi(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ai=t}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||oi(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ci(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return ci(this)},Oe.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var c;if(r.length>0&&(c=r[0]),c instanceof Error)throw c;var u=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw u.context=c,u}var h=s[e];if(h===void 0)return!1;if(typeof h=="function")si(h,this,r);else for(var f=h.length,_=di(h,f),n=0;n<f;++n)si(_[n],this,r);return!0};function ui(t,e,r,n){var i,s,c;if(wr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),c=s[e]),c===void 0)c=s[e]=r,++t._eventsCount;else if(typeof c=="function"?c=s[e]=n?[r,c]:[c,r]:n?c.unshift(r):c.push(r),i=ci(t),i>0&&c.length>i&&!c.warned){c.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=c.length,Ia(u)}return t}Oe.prototype.addListener=function(e,r){return ui(this,e,r,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(e,r){return ui(this,e,r,!0)};function Ra(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function fi(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Ra.bind(n);return i.listener=r,n.wrapFn=i,i}Oe.prototype.once=function(e,r){return wr(r),this.on(e,fi(this,e,r)),this},Oe.prototype.prependOnceListener=function(e,r){return wr(r),this.prependListener(e,fi(this,e,r)),this},Oe.prototype.removeListener=function(e,r){var n,i,s,c,u;if(wr(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,c=n.length-1;c>=0;c--)if(n[c]===r||n[c].listener===r){u=n[c].listener,s=c;break}if(s<0)return this;s===0?n.shift():Ca(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,u||r)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),c;for(i=0;i<s.length;++i)c=s[i],c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function hi(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Aa(i):di(i,i.length)}Oe.prototype.listeners=function(e){return hi(this,e,!0)},Oe.prototype.rawListeners=function(e){return hi(this,e,!1)},Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):li.call(t,e)},Oe.prototype.listenerCount=li;function li(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Er(this._events):[]};function di(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Ca(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Aa(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Pa(t,e){return new Promise(function(r,n){function i(c){t.removeListener(e,s),n(c)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}gi(t,e,s,{once:!0}),e!=="error"&&La(t,i,{once:!0})})}function La(t,e,r){typeof t.on=="function"&&gi(t,"error",e,r)}function gi(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var mr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Xr=function(t,e){return Xr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Xr(t,e)};function Na(t,e){Xr(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var kr=function(){return kr=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},kr.apply(this,arguments)};function Ua(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Ma(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function ja(t,e){return function(r,n){e(r,n,t)}}function $a(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Fa(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(_){try{f(n.next(_))}catch(O){c(O)}}function h(_){try{f(n.throw(_))}catch(O){c(O)}}function f(_){_.done?s(_.value):i(_.value).then(u,h)}f((n=n.apply(t,e||[])).next())})}function Ba(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(_){return h([f,_])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function za(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Ha(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Jr(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function _i(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function Ka(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(_i(arguments[e]));return t}function Ga(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function Xt(t){return this instanceof Xt?(this.v=t,this):new Xt(t)}function Va(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(p){n[p]&&(i[p]=function(E){return new Promise(function(C,A){s.push([p,E,C,A])>1||u(p,E)})})}function u(p,E){try{h(n[p](E))}catch(C){O(s[0][3],C)}}function h(p){p.value instanceof Xt?Promise.resolve(p.value.v).then(f,_):O(s[0][2],p)}function f(p){u("next",p)}function _(p){u("throw",p)}function O(p,E){p(E),s.shift(),s.length&&u(s[0][0],s[0][1])}}function qa(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:Xt(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function Wa(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Jr=="function"?Jr(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,h){c=t[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function Ya(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Xa(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function ka(t){return t&&t.__esModule?t:{default:t}}function Ja(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Za(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Qa=Object.freeze({__proto__:null,__extends:Na,get __assign(){return kr},__rest:Ua,__decorate:Ma,__param:ja,__metadata:$a,__awaiter:Fa,__generator:Ba,__createBinding:za,__exportStar:Ha,__values:Jr,__read:_i,__spread:Ka,__spreadArrays:Ga,__await:Xt,__asyncGenerator:Va,__asyncDelegator:qa,__asyncValues:Wa,__makeTemplateObject:Ya,__importStar:Xa,__importDefault:ka,__classPrivateFieldGet:Ja,__classPrivateFieldSet:Za}),yi=Rt(Qa),kt={};Object.defineProperty(kt,"__esModule",{value:!0});function ec(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}kt.safeJsonParse=ec;function tc(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}kt.safeJsonStringify=tc;var Jt={exports:{}},pi;function rc(){return pi||(pi=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Je<"u"&&Je.localStorage?Jt.exports=Je.localStorage:typeof window<"u"&&window.localStorage?Jt.exports=window.localStorage:Jt.exports=new e}()),Jt.exports}var Zr={},Zt={},bi;function nc(){if(bi)return Zt;bi=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.IKeyValueStorage=void 0;class t{}return Zt.IKeyValueStorage=t,Zt}var Qt={},vi;function ic(){if(vi)return Qt;vi=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.parseEntry=void 0;const t=kt;function e(r){var n;return[r[0],t.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return Qt.parseEntry=e,Qt}var Ei;function sc(){return Ei||(Ei=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yi;e.__exportStar(nc(),t),e.__exportStar(ic(),t)}(Zr)),Zr}Object.defineProperty(mr,"__esModule",{value:!0}),mr.KeyValueStorage=void 0;const zt=yi,wi=kt,oc=zt.__importDefault(rc()),ac=sc();class mi{constructor(){this.localStorage=oc.default}getKeys(){return zt.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return zt.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(ac.parseEntry)})}getItem(e){return zt.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return wi.safeJsonParse(r)})}setItem(e,r){return zt.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,wi.safeJsonStringify(r))})}removeItem(e){return zt.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}mr.KeyValueStorage=mi;var cc=mr.default=mi,er={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Qr=function(t,e){return Qr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Qr(t,e)};function uc(t,e){Qr(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var en=function(){return en=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},en.apply(this,arguments)};function fc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function hc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function lc(t,e){return function(r,n){e(r,n,t)}}function dc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function gc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(_){try{f(n.next(_))}catch(O){c(O)}}function h(_){try{f(n.throw(_))}catch(O){c(O)}}function f(_){_.done?s(_.value):i(_.value).then(u,h)}f((n=n.apply(t,e||[])).next())})}function _c(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(_){return h([f,_])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function yc(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function pc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function tn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Di(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function bc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Di(arguments[e]));return t}function vc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function tr(t){return this instanceof tr?(this.v=t,this):new tr(t)}function Ec(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(p){n[p]&&(i[p]=function(E){return new Promise(function(C,A){s.push([p,E,C,A])>1||u(p,E)})})}function u(p,E){try{h(n[p](E))}catch(C){O(s[0][3],C)}}function h(p){p.value instanceof tr?Promise.resolve(p.value.v).then(f,_):O(s[0][2],p)}function f(p){u("next",p)}function _(p){u("throw",p)}function O(p,E){p(E),s.shift(),s.length&&u(s[0][0],s[0][1])}}function wc(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:tr(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function mc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof tn=="function"?tn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,h){c=t[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function Dc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Sc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Oc(t){return t&&t.__esModule?t:{default:t}}function Tc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function xc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Ic=Object.freeze({__proto__:null,__extends:uc,get __assign(){return en},__rest:fc,__decorate:hc,__param:lc,__metadata:dc,__awaiter:gc,__generator:_c,__createBinding:yc,__exportStar:pc,__values:tn,__read:Di,__spread:bc,__spreadArrays:vc,__await:tr,__asyncGenerator:Ec,__asyncDelegator:wc,__asyncValues:mc,__makeTemplateObject:Dc,__importStar:Sc,__importDefault:Oc,__classPrivateFieldGet:Tc,__classPrivateFieldSet:xc}),Dr=Rt(Ic),rr={},ce={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var rn=function(t,e){return rn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},rn(t,e)};function Rc(t,e){rn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var nn=function(){return nn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},nn.apply(this,arguments)};function Cc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Ac(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Pc(t,e){return function(r,n){e(r,n,t)}}function Lc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Nc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(_){try{f(n.next(_))}catch(O){c(O)}}function h(_){try{f(n.throw(_))}catch(O){c(O)}}function f(_){_.done?s(_.value):i(_.value).then(u,h)}f((n=n.apply(t,e||[])).next())})}function Uc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(_){return h([f,_])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Mc(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function jc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function sn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Si(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function $c(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Si(arguments[e]));return t}function Fc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function nr(t){return this instanceof nr?(this.v=t,this):new nr(t)}function Bc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(p){n[p]&&(i[p]=function(E){return new Promise(function(C,A){s.push([p,E,C,A])>1||u(p,E)})})}function u(p,E){try{h(n[p](E))}catch(C){O(s[0][3],C)}}function h(p){p.value instanceof nr?Promise.resolve(p.value.v).then(f,_):O(s[0][2],p)}function f(p){u("next",p)}function _(p){u("throw",p)}function O(p,E){p(E),s.shift(),s.length&&u(s[0][0],s[0][1])}}function zc(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:nr(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function Hc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof sn=="function"?sn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,h){c=t[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function Kc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Gc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Vc(t){return t&&t.__esModule?t:{default:t}}function qc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Wc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Yc=Object.freeze({__proto__:null,__extends:Rc,get __assign(){return nn},__rest:Cc,__decorate:Ac,__param:Pc,__metadata:Lc,__awaiter:Nc,__generator:Uc,__createBinding:Mc,__exportStar:jc,__values:sn,__read:Si,__spread:$c,__spreadArrays:Fc,__await:nr,__asyncGenerator:Bc,__asyncDelegator:zc,__asyncValues:Hc,__makeTemplateObject:Kc,__importStar:Gc,__importDefault:Vc,__classPrivateFieldGet:qc,__classPrivateFieldSet:Wc}),Sr=Rt(Yc),on={},ir={},Oi;function Xc(){if(Oi)return ir;Oi=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return ir.delay=t,ir}var Ct={},an={},At={},Ti;function kc(){return Ti||(Ti=1,Object.defineProperty(At,"__esModule",{value:!0}),At.ONE_THOUSAND=At.ONE_HUNDRED=void 0,At.ONE_HUNDRED=100,At.ONE_THOUSAND=1e3),At}var cn={},xi;function Jc(){return xi||(xi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(cn)),cn}var Ii;function Ri(){return Ii||(Ii=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Sr;e.__exportStar(kc(),t),e.__exportStar(Jc(),t)}(an)),an}var Ci;function Zc(){if(Ci)return Ct;Ci=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.fromMiliseconds=Ct.toMiliseconds=void 0;const t=Ri();function e(n){return n*t.ONE_THOUSAND}Ct.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Ct.fromMiliseconds=r,Ct}var Ai;function Qc(){return Ai||(Ai=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Sr;e.__exportStar(Xc(),t),e.__exportStar(Zc(),t)}(on)),on}var Ht={},Pi;function eu(){if(Pi)return Ht;Pi=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return Ht.Watch=t,Ht.default=t,Ht}var un={},sr={},Li;function tu(){if(Li)return sr;Li=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.IWatch=void 0;class t{}return sr.IWatch=t,sr}var Ni;function ru(){return Ni||(Ni=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Sr.__exportStar(tu(),t)}(un)),un}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Sr;e.__exportStar(Qc(),t),e.__exportStar(eu(),t),e.__exportStar(ru(),t),e.__exportStar(Ri(),t)})(ce);var fn={},or={};class Pt{}var nu=Object.freeze({__proto__:null,IEvents:Pt}),iu=Rt(nu),Ui;function su(){if(Ui)return or;Ui=1,Object.defineProperty(or,"__esModule",{value:!0}),or.IHeartBeat=void 0;const t=iu;class e extends t.IEvents{constructor(n){super()}}return or.IHeartBeat=e,or}var Mi;function ji(){return Mi||(Mi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Dr.__exportStar(su(),t)}(fn)),fn}var hn={},Lt={},$i;function ou(){if($i)return Lt;$i=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.HEARTBEAT_EVENTS=Lt.HEARTBEAT_INTERVAL=void 0;const t=ce;return Lt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Lt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Lt}var Fi;function Bi(){return Fi||(Fi=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Dr.__exportStar(ou(),t)}(hn)),hn}var zi;function au(){if(zi)return rr;zi=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.HeartBeat=void 0;const t=Dr,e=ut.exports,r=ce,n=ji(),i=Bi();class s extends n.IHeartBeat{constructor(u){super(u),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=u?.interval||i.HEARTBEAT_INTERVAL}static init(u){return t.__awaiter(this,void 0,void 0,function*(){const h=new s(u);return yield h.init(),h})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(u,h){this.events.on(u,h)}once(u,h){this.events.once(u,h)}off(u,h){this.events.off(u,h)}removeListener(u,h){this.events.removeListener(u,h)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return rr.HeartBeat=s,rr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Dr;e.__exportStar(au(),t),e.__exportStar(ji(),t),e.__exportStar(Bi(),t)})(er);var Se={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ln=function(t,e){return ln=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ln(t,e)};function cu(t,e){ln(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var dn=function(){return dn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},dn.apply(this,arguments)};function uu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function fu(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function hu(t,e){return function(r,n){e(r,n,t)}}function lu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function du(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(_){try{f(n.next(_))}catch(O){c(O)}}function h(_){try{f(n.throw(_))}catch(O){c(O)}}function f(_){_.done?s(_.value):i(_.value).then(u,h)}f((n=n.apply(t,e||[])).next())})}function gu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(_){return h([f,_])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function _u(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function yu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function gn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Hi(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function pu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Hi(arguments[e]));return t}function bu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function ar(t){return this instanceof ar?(this.v=t,this):new ar(t)}function vu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(p){n[p]&&(i[p]=function(E){return new Promise(function(C,A){s.push([p,E,C,A])>1||u(p,E)})})}function u(p,E){try{h(n[p](E))}catch(C){O(s[0][3],C)}}function h(p){p.value instanceof ar?Promise.resolve(p.value.v).then(f,_):O(s[0][2],p)}function f(p){u("next",p)}function _(p){u("throw",p)}function O(p,E){p(E),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Eu(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:ar(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function wu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof gn=="function"?gn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,h){c=t[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function mu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Du(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Su(t){return t&&t.__esModule?t:{default:t}}function Ou(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Tu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var xu=Object.freeze({__proto__:null,__extends:cu,get __assign(){return dn},__rest:uu,__decorate:fu,__param:hu,__metadata:lu,__awaiter:du,__generator:gu,__createBinding:_u,__exportStar:yu,__values:gn,__read:Hi,__spread:pu,__spreadArrays:bu,__await:ar,__asyncGenerator:vu,__asyncDelegator:Eu,__asyncValues:wu,__makeTemplateObject:mu,__importStar:Du,__importDefault:Su,__classPrivateFieldGet:Ou,__classPrivateFieldSet:Tu}),Iu=Rt(xu),_n,Ki;function Ru(){if(Ki)return _n;Ki=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}_n=e;function e(r,n,i){var s=i&&i.stringify||t,c=1;if(typeof r=="object"&&r!==null){var u=n.length+c;if(u===1)return r;var h=new Array(u);h[0]=s(r);for(var f=1;f<u;f++)h[f]=s(n[f]);return h.join(" ")}if(typeof r!="string")return r;var _=n.length;if(_===0)return r;for(var O="",p=1-c,E=-1,C=r&&r.length||0,A=0;A<C;){if(r.charCodeAt(A)===37&&A+1<C){switch(E=E>-1?E:0,r.charCodeAt(A+1)){case 100:case 102:if(p>=_||n[p]==null)break;E<A&&(O+=r.slice(E,A)),O+=Number(n[p]),E=A+2,A++;break;case 105:if(p>=_||n[p]==null)break;E<A&&(O+=r.slice(E,A)),O+=Math.floor(Number(n[p])),E=A+2,A++;break;case 79:case 111:case 106:if(p>=_||n[p]===void 0)break;E<A&&(O+=r.slice(E,A));var U=typeof n[p];if(U==="string"){O+="'"+n[p]+"'",E=A+2,A++;break}if(U==="function"){O+=n[p].name||"<anonymous>",E=A+2,A++;break}O+=s(n[p]),E=A+2,A++;break;case 115:if(p>=_)break;E<A&&(O+=r.slice(E,A)),O+=String(n[p]),E=A+2,A++;break;case 37:E<A&&(O+=r.slice(E,A)),O+="%",E=A+2,A++,p--;break}++p}++A}return E===-1?r:(E<C&&(O+=r.slice(E)),O)}return _n}var yn,Gi;function Cu(){if(Gi)return yn;Gi=1;const t=Ru();yn=i;const e=v().console||{},r={mapHttpRequest:C,mapHttpResponse:C,wrapRequestSerializer:A,wrapResponseSerializer:A,wrapErrorSerializer:A,req:C,res:C,err:p};function n(d,o){return Array.isArray(d)?d.filter(function(L){return L!=="!stdSerializers.err"}):d===!0?Object.keys(o):!1}function i(d){d=d||{},d.browser=d.browser||{};const o=d.browser.transmit;if(o&&typeof o.send!="function")throw Error("pino: transmit option must have a send function");const l=d.browser.write||e;d.browser.write&&(d.browser.asObject=!0);const L=d.serializers||{},P=n(d.browser.serialize,L);let H=d.browser.serialize;Array.isArray(d.browser.serialize)&&d.browser.serialize.indexOf("!stdSerializers.err")>-1&&(H=!1);const G=["error","fatal","warn","info","debug","trace"];typeof l=="function"&&(l.error=l.fatal=l.warn=l.info=l.debug=l.trace=l),d.enabled===!1&&(d.level="silent");const J=d.level||"info",D=Object.create(l);D.log||(D.log=U),Object.defineProperty(D,"levelVal",{get:V}),Object.defineProperty(D,"level",{get:F,set:M});const I={transmit:o,serialize:P,asObject:d.browser.asObject,levels:G,timestamp:E(d)};D.levels=i.levels,D.level=J,D.setMaxListeners=D.getMaxListeners=D.emit=D.addListener=D.on=D.prependListener=D.once=D.prependOnceListener=D.removeListener=D.removeAllListeners=D.listeners=D.listenerCount=D.eventNames=D.write=D.flush=U,D.serializers=L,D._serialize=P,D._stdErrSerialize=H,D.child=$,o&&(D._logEvent=O());function V(){return this.level==="silent"?1/0:this.levels.values[this.level]}function F(){return this._level}function M(N){if(N!=="silent"&&!this.levels.values[N])throw Error("unknown level "+N);this._level=N,s(I,D,"error","log"),s(I,D,"fatal","error"),s(I,D,"warn","error"),s(I,D,"info","log"),s(I,D,"debug","log"),s(I,D,"trace","log")}function $(N,B){if(!N)throw new Error("missing bindings for child Pino");B=B||{},P&&N.serializers&&(B.serializers=N.serializers);const ee=B.serializers;if(P&&ee){var z=Object.assign({},L,ee),Z=d.browser.serialize===!0?Object.keys(z):P;delete N.serializers,h([N],Z,z,this._stdErrSerialize)}function Y(Q){this._childLevel=(Q._childLevel|0)+1,this.error=f(Q,N,"error"),this.fatal=f(Q,N,"fatal"),this.warn=f(Q,N,"warn"),this.info=f(Q,N,"info"),this.debug=f(Q,N,"debug"),this.trace=f(Q,N,"trace"),z&&(this.serializers=z,this._serialize=Z),o&&(this._logEvent=O([].concat(Q._logEvent.bindings,N)))}return Y.prototype=this,new Y(this)}return D}i.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},i.stdSerializers=r,i.stdTimeFunctions=Object.assign({},{nullTime:W,epochTime:S,unixTime:R,isoTime:b});function s(d,o,l,L){const P=Object.getPrototypeOf(o);o[l]=o.levelVal>o.levels.values[l]?U:P[l]?P[l]:e[l]||e[L]||U,c(d,o,l)}function c(d,o,l){!d.transmit&&o[l]===U||(o[l]=function(L){return function(){const H=d.timestamp(),G=new Array(arguments.length),J=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var D=0;D<G.length;D++)G[D]=arguments[D];if(d.serialize&&!d.asObject&&h(G,this._serialize,this.serializers,this._stdErrSerialize),d.asObject?L.call(J,u(this,l,G,H)):L.apply(J,G),d.transmit){const I=d.transmit.level||o.level,V=i.levels.values[I],F=i.levels.values[l];if(F<V)return;_(this,{ts:H,methodLevel:l,methodValue:F,transmitLevel:I,transmitValue:i.levels.values[d.transmit.level||o.level],send:d.transmit.send,val:o.levelVal},G)}}}(o[l]))}function u(d,o,l,L){d._serialize&&h(l,d._serialize,d.serializers,d._stdErrSerialize);const P=l.slice();let H=P[0];const G={};L&&(G.time=L),G.level=i.levels.values[o];let J=(d._childLevel|0)+1;if(J<1&&(J=1),H!==null&&typeof H=="object"){for(;J--&&typeof P[0]=="object";)Object.assign(G,P.shift());H=P.length?t(P.shift(),P):void 0}else typeof H=="string"&&(H=t(P.shift(),P));return H!==void 0&&(G.msg=H),G}function h(d,o,l,L){for(const P in d)if(L&&d[P]instanceof Error)d[P]=i.stdSerializers.err(d[P]);else if(typeof d[P]=="object"&&!Array.isArray(d[P]))for(const H in d[P])o&&o.indexOf(H)>-1&&H in l&&(d[P][H]=l[H](d[P][H]))}function f(d,o,l){return function(){const L=new Array(1+arguments.length);L[0]=o;for(var P=1;P<L.length;P++)L[P]=arguments[P-1];return d[l].apply(this,L)}}function _(d,o,l){const L=o.send,P=o.ts,H=o.methodLevel,G=o.methodValue,J=o.val,D=d._logEvent.bindings;h(l,d._serialize||Object.keys(d.serializers),d.serializers,d._stdErrSerialize===void 0?!0:d._stdErrSerialize),d._logEvent.ts=P,d._logEvent.messages=l.filter(function(I){return D.indexOf(I)===-1}),d._logEvent.level.label=H,d._logEvent.level.value=G,L(H,d._logEvent,J),d._logEvent=O(D)}function O(d){return{ts:0,messages:[],bindings:d||[],level:{label:"",value:0}}}function p(d){const o={type:d.constructor.name,msg:d.message,stack:d.stack};for(const l in d)o[l]===void 0&&(o[l]=d[l]);return o}function E(d){return typeof d.timestamp=="function"?d.timestamp:d.timestamp===!1?W:S}function C(){return{}}function A(d){return d}function U(){}function W(){return!1}function S(){return Date.now()}function R(){return Math.round(Date.now()/1e3)}function b(){return new Date(Date.now()).toISOString()}function v(){function d(o){return typeof o<"u"&&o}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return d(self)||d(window)||d(this)||{}}}return yn}var Nt={},Vi;function qi(){return Vi||(Vi=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.PINO_CUSTOM_CONTEXT_KEY=Nt.PINO_LOGGER_DEFAULTS=void 0,Nt.PINO_LOGGER_DEFAULTS={level:"info"},Nt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Nt}var rt={},Wi;function Au(){if(Wi)return rt;Wi=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.generateChildLogger=rt.formatChildLoggerContext=rt.getLoggerContext=rt.setBrowserLoggerContext=rt.getBrowserLoggerContext=rt.getDefaultLoggerOptions=void 0;const t=qi();function e(u){return Object.assign(Object.assign({},u),{level:u?.level||t.PINO_LOGGER_DEFAULTS.level})}rt.getDefaultLoggerOptions=e;function r(u,h=t.PINO_CUSTOM_CONTEXT_KEY){return u[h]||""}rt.getBrowserLoggerContext=r;function n(u,h,f=t.PINO_CUSTOM_CONTEXT_KEY){return u[f]=h,u}rt.setBrowserLoggerContext=n;function i(u,h=t.PINO_CUSTOM_CONTEXT_KEY){let f="";return typeof u.bindings>"u"?f=r(u,h):f=u.bindings().context||"",f}rt.getLoggerContext=i;function s(u,h,f=t.PINO_CUSTOM_CONTEXT_KEY){const _=i(u,f);return _.trim()?`${_}/${h}`:h}rt.formatChildLoggerContext=s;function c(u,h,f=t.PINO_CUSTOM_CONTEXT_KEY){const _=s(u,h,f),O=u.child({context:_});return n(O,_,f)}return rt.generateChildLogger=c,rt}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Iu,r=e.__importDefault(Cu());Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(qi(),t),e.__exportStar(Au(),t)})(Se);class Pu extends Pt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Lu extends Pt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Nu{constructor(e,r){this.logger=e,this.core=r}}class Uu extends Pt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Mu extends Pt{constructor(e){super()}}class ju{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class $u extends Pt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Fu extends Pt{constructor(e,r){super(),this.core=e,this.logger=r}}class Bu{constructor(e,r){this.projectId=e,this.logger=r}}const zu=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),Hu=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(n,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function Yi(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return Hu(t)}catch{return t}}function pn(t){return typeof t=="string"?t:zu(t)||""}var bn={},Kt={},Or={},Tr={};Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.BrowserRandomSource=void 0;const Xi=65536;class Ku{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let n=0;n<r.length;n+=Xi)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Xi)));return r}}Tr.BrowserRandomSource=Ku;function Gu(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xr={},ot={};Object.defineProperty(ot,"__esModule",{value:!0});function Vu(t){for(var e=0;e<t.length;e++)t[e]=0;return t}ot.wipe=Vu;var qu={},Wu=Object.freeze({__proto__:null,default:qu}),Yu=Rt(Wu);Object.defineProperty(xr,"__esModule",{value:!0}),xr.NodeRandomSource=void 0;const Xu=ot;class ku{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Gu<"u"){const e=Yu;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,Xu.wipe)(r),n}}xr.NodeRandomSource=ku,Object.defineProperty(Or,"__esModule",{value:!0}),Or.SystemRandomSource=void 0;const Ju=Tr,Zu=xr;class Qu{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Ju.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Zu.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Or.SystemRandomSource=Qu;var re={},ki={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(u,h){var f=u>>>16&65535,_=u&65535,O=h>>>16&65535,p=h&65535;return _*p+(f*p+_*O<<16>>>0)|0}t.mul=Math.imul||e;function r(u,h){return u+h|0}t.add=r;function n(u,h){return u-h|0}t.sub=n;function i(u,h){return u<<h|u>>>32-h}t.rotl=i;function s(u,h){return u<<32-h|u>>>h}t.rotr=s;function c(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}t.isInteger=Number.isInteger||c,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(u){return t.isInteger(u)&&u>=-t.MAX_SAFE_INTEGER&&u<=t.MAX_SAFE_INTEGER}})(ki),Object.defineProperty(re,"__esModule",{value:!0});var Ji=ki;function ef(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}re.readInt16BE=ef;function tf(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}re.readUint16BE=tf;function rf(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}re.readInt16LE=rf;function nf(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}re.readUint16LE=nf;function Zi(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}re.writeUint16BE=Zi,re.writeInt16BE=Zi;function Qi(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}re.writeUint16LE=Qi,re.writeInt16LE=Qi;function vn(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}re.readInt32BE=vn;function En(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}re.readUint32BE=En;function wn(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}re.readInt32LE=wn;function mn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}re.readUint32LE=mn;function Ir(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}re.writeUint32BE=Ir,re.writeInt32BE=Ir;function Rr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}re.writeUint32LE=Rr,re.writeInt32LE=Rr;function sf(t,e){e===void 0&&(e=0);var r=vn(t,e),n=vn(t,e+4);return r*4294967296+n-(n>>31)*4294967296}re.readInt64BE=sf;function of(t,e){e===void 0&&(e=0);var r=En(t,e),n=En(t,e+4);return r*4294967296+n}re.readUint64BE=of;function af(t,e){e===void 0&&(e=0);var r=wn(t,e),n=wn(t,e+4);return n*4294967296+r-(r>>31)*4294967296}re.readInt64LE=af;function cf(t,e){e===void 0&&(e=0);var r=mn(t,e),n=mn(t,e+4);return n*4294967296+r}re.readUint64LE=cf;function es(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Ir(t/4294967296>>>0,e,r),Ir(t>>>0,e,r+4),e}re.writeUint64BE=es,re.writeInt64BE=es;function ts(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Rr(t>>>0,e,r),Rr(t/4294967296>>>0,e,r+4),e}re.writeUint64LE=ts,re.writeInt64LE=ts;function uf(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=t/8+r-1;s>=r;s--)n+=e[s]*i,i*=256;return n}re.readUintBE=uf;function ff(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+t/8;s++)n+=e[s]*i,i*=256;return n}re.readUintLE=ff;function hf(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ji.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=t/8+n-1;s>=n;s--)r[s]=e/i&255,i*=256;return r}re.writeUintBE=hf;function lf(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ji.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+t/8;s++)r[s]=e/i&255,i*=256;return r}re.writeUintLE=lf;function df(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}re.readFloat32BE=df;function gf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}re.readFloat32LE=gf;function _f(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}re.readFloat64BE=_f;function yf(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}re.readFloat64LE=yf;function pf(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}re.writeFloat32BE=pf;function bf(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}re.writeFloat32LE=bf;function vf(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}re.writeFloat64BE=vf;function Ef(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}re.writeFloat64LE=Ef,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Or,r=re,n=ot;t.defaultRandomSource=new e.SystemRandomSource;function i(f,_=t.defaultRandomSource){return _.randomBytes(f)}t.randomBytes=i;function s(f=t.defaultRandomSource){const _=i(4,f),O=(0,r.readUint32LE)(_);return(0,n.wipe)(_),O}t.randomUint32=s;const c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(f,_=c,O=t.defaultRandomSource){if(_.length<2)throw new Error("randomString charset is too short");if(_.length>256)throw new Error("randomString charset is too long");let p="";const E=_.length,C=256-256%E;for(;f>0;){const A=i(Math.ceil(f*256/C),O);for(let U=0;U<A.length&&f>0;U++){const W=A[U];W<C&&(p+=_.charAt(W%E),f--)}(0,n.wipe)(A)}return p}t.randomString=u;function h(f,_=c,O=t.defaultRandomSource){const p=Math.ceil(f/(Math.log(_.length)/Math.LN2));return u(p,_,O)}t.randomStringForEntropy=h}(Kt);var rs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=ot;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},u.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var _=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&f>0;)this._buffer[this._bufferLength++]=h[_++],f--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(_=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,_,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[_++],f--;return this},u.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,_=this._bufferLength,O=f/536870912|0,p=f<<3,E=f%128<112?128:256;this._buffer[_]=128;for(var C=_+1;C<E-8;C++)this._buffer[C]=0;e.writeUint32BE(O,this._buffer,E-8),e.writeUint32BE(p,this._buffer,E-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,E),this._finished=!0}for(var C=0;C<this.digestLength/8;C++)e.writeUint32BE(this._stateHi[C],h,C*8),e.writeUint32BE(this._stateLo[C],h,C*8+4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(u,h,f,_,O,p,E){for(var C=f[0],A=f[1],U=f[2],W=f[3],S=f[4],R=f[5],b=f[6],v=f[7],d=_[0],o=_[1],l=_[2],L=_[3],P=_[4],H=_[5],G=_[6],J=_[7],D,I,V,F,M,$,N,B;E>=128;){for(var ee=0;ee<16;ee++){var z=8*ee+p;u[ee]=e.readUint32BE(O,z),h[ee]=e.readUint32BE(O,z+4)}for(var ee=0;ee<80;ee++){var Z=C,Y=A,Q=U,x=W,T=S,w=R,a=b,y=v,K=d,q=o,he=l,pe=L,de=P,Ee=H,Ue=G,Ae=J;if(D=v,I=J,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=(S>>>14|P<<32-14)^(S>>>18|P<<32-18)^(P>>>41-32|S<<32-(41-32)),I=(P>>>14|S<<32-14)^(P>>>18|S<<32-18)^(S>>>41-32|P<<32-(41-32)),M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,D=S&R^~S&b,I=P&H^~P&G,M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,D=i[ee*2],I=i[ee*2+1],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,D=u[ee%16],I=h[ee%16],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,V=N&65535|B<<16,F=M&65535|$<<16,D=V,I=F,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=(C>>>28|d<<32-28)^(d>>>34-32|C<<32-(34-32))^(d>>>39-32|C<<32-(39-32)),I=(d>>>28|C<<32-28)^(C>>>34-32|d<<32-(34-32))^(C>>>39-32|d<<32-(39-32)),M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,D=C&A^C&U^A&U,I=d&o^d&l^o&l,M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,y=N&65535|B<<16,Ae=M&65535|$<<16,D=x,I=pe,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=V,I=F,M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,x=N&65535|B<<16,pe=M&65535|$<<16,A=Z,U=Y,W=Q,S=x,R=T,b=w,v=a,C=y,o=K,l=q,L=he,P=pe,H=de,G=Ee,J=Ue,d=Ae,ee%16===15)for(var z=0;z<16;z++)D=u[z],I=h[z],M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=u[(z+9)%16],I=h[(z+9)%16],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,V=u[(z+1)%16],F=h[(z+1)%16],D=(V>>>1|F<<32-1)^(V>>>8|F<<32-8)^V>>>7,I=(F>>>1|V<<32-1)^(F>>>8|V<<32-8)^(F>>>7|V<<32-7),M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,V=u[(z+14)%16],F=h[(z+14)%16],D=(V>>>19|F<<32-19)^(F>>>61-32|V<<32-(61-32))^V>>>6,I=(F>>>19|V<<32-19)^(V>>>61-32|F<<32-(61-32))^(F>>>6|V<<32-6),M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,u[z]=N&65535|B<<16,h[z]=M&65535|$<<16}D=C,I=d,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[0],I=_[0],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[0]=C=N&65535|B<<16,_[0]=d=M&65535|$<<16,D=A,I=o,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[1],I=_[1],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[1]=A=N&65535|B<<16,_[1]=o=M&65535|$<<16,D=U,I=l,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[2],I=_[2],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[2]=U=N&65535|B<<16,_[2]=l=M&65535|$<<16,D=W,I=L,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[3],I=_[3],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[3]=W=N&65535|B<<16,_[3]=L=M&65535|$<<16,D=S,I=P,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[4],I=_[4],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[4]=S=N&65535|B<<16,_[4]=P=M&65535|$<<16,D=R,I=H,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[5],I=_[5],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[5]=R=N&65535|B<<16,_[5]=H=M&65535|$<<16,D=b,I=G,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[6],I=_[6],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[6]=b=N&65535|B<<16,_[6]=G=M&65535|$<<16,D=v,I=J,M=I&65535,$=I>>>16,N=D&65535,B=D>>>16,D=f[7],I=_[7],M+=I&65535,$+=I>>>16,N+=D&65535,B+=D>>>16,$+=M>>>16,N+=$>>>16,B+=N>>>16,f[7]=v=N&65535|B<<16,_[7]=J=M&65535|$<<16,p+=128,E-=128}return p}function c(u){var h=new n;h.update(u);var f=h.digest();return h.clean(),f}t.hash=c})(rs),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=Kt,r=rs,n=ot;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function i(x){const T=new Float64Array(16);if(x)for(let w=0;w<x.length;w++)T[w]=x[w];return T}const s=new Uint8Array(32);s[0]=9;const c=i(),u=i([1]),h=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),O=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function E(x,T){for(let w=0;w<16;w++)x[w]=T[w]|0}function C(x){let T=1;for(let w=0;w<16;w++){let a=x[w]+T+65535;T=Math.floor(a/65536),x[w]=a-T*65536}x[0]+=T-1+37*(T-1)}function A(x,T,w){const a=~(w-1);for(let y=0;y<16;y++){const K=a&(x[y]^T[y]);x[y]^=K,T[y]^=K}}function U(x,T){const w=i(),a=i();for(let y=0;y<16;y++)a[y]=T[y];C(a),C(a),C(a);for(let y=0;y<2;y++){w[0]=a[0]-65517;for(let q=1;q<15;q++)w[q]=a[q]-65535-(w[q-1]>>16&1),w[q-1]&=65535;w[15]=a[15]-32767-(w[14]>>16&1);const K=w[15]>>16&1;w[14]&=65535,A(a,w,1-K)}for(let y=0;y<16;y++)x[2*y]=a[y]&255,x[2*y+1]=a[y]>>8}function W(x,T){let w=0;for(let a=0;a<32;a++)w|=x[a]^T[a];return(1&w-1>>>8)-1}function S(x,T){const w=new Uint8Array(32),a=new Uint8Array(32);return U(w,x),U(a,T),W(w,a)}function R(x){const T=new Uint8Array(32);return U(T,x),T[0]&1}function b(x,T){for(let w=0;w<16;w++)x[w]=T[2*w]+(T[2*w+1]<<8);x[15]&=32767}function v(x,T,w){for(let a=0;a<16;a++)x[a]=T[a]+w[a]}function d(x,T,w){for(let a=0;a<16;a++)x[a]=T[a]-w[a]}function o(x,T,w){let a,y,K=0,q=0,he=0,pe=0,de=0,Ee=0,Ue=0,Ae=0,ye=0,ge=0,le=0,ue=0,ae=0,oe=0,se=0,te=0,fe=0,_e=0,ne=0,be=0,ve=0,me=0,De=0,we=0,_t=0,bt=0,Ot=0,at=0,Mt=0,pr=0,Hr=0,Me=w[0],Pe=w[1],je=w[2],$e=w[3],Fe=w[4],Le=w[5],Ke=w[6],Ge=w[7],Ve=w[8],qe=w[9],We=w[10],He=w[11],Be=w[12],Re=w[13],Ye=w[14],Xe=w[15];a=T[0],K+=a*Me,q+=a*Pe,he+=a*je,pe+=a*$e,de+=a*Fe,Ee+=a*Le,Ue+=a*Ke,Ae+=a*Ge,ye+=a*Ve,ge+=a*qe,le+=a*We,ue+=a*He,ae+=a*Be,oe+=a*Re,se+=a*Ye,te+=a*Xe,a=T[1],q+=a*Me,he+=a*Pe,pe+=a*je,de+=a*$e,Ee+=a*Fe,Ue+=a*Le,Ae+=a*Ke,ye+=a*Ge,ge+=a*Ve,le+=a*qe,ue+=a*We,ae+=a*He,oe+=a*Be,se+=a*Re,te+=a*Ye,fe+=a*Xe,a=T[2],he+=a*Me,pe+=a*Pe,de+=a*je,Ee+=a*$e,Ue+=a*Fe,Ae+=a*Le,ye+=a*Ke,ge+=a*Ge,le+=a*Ve,ue+=a*qe,ae+=a*We,oe+=a*He,se+=a*Be,te+=a*Re,fe+=a*Ye,_e+=a*Xe,a=T[3],pe+=a*Me,de+=a*Pe,Ee+=a*je,Ue+=a*$e,Ae+=a*Fe,ye+=a*Le,ge+=a*Ke,le+=a*Ge,ue+=a*Ve,ae+=a*qe,oe+=a*We,se+=a*He,te+=a*Be,fe+=a*Re,_e+=a*Ye,ne+=a*Xe,a=T[4],de+=a*Me,Ee+=a*Pe,Ue+=a*je,Ae+=a*$e,ye+=a*Fe,ge+=a*Le,le+=a*Ke,ue+=a*Ge,ae+=a*Ve,oe+=a*qe,se+=a*We,te+=a*He,fe+=a*Be,_e+=a*Re,ne+=a*Ye,be+=a*Xe,a=T[5],Ee+=a*Me,Ue+=a*Pe,Ae+=a*je,ye+=a*$e,ge+=a*Fe,le+=a*Le,ue+=a*Ke,ae+=a*Ge,oe+=a*Ve,se+=a*qe,te+=a*We,fe+=a*He,_e+=a*Be,ne+=a*Re,be+=a*Ye,ve+=a*Xe,a=T[6],Ue+=a*Me,Ae+=a*Pe,ye+=a*je,ge+=a*$e,le+=a*Fe,ue+=a*Le,ae+=a*Ke,oe+=a*Ge,se+=a*Ve,te+=a*qe,fe+=a*We,_e+=a*He,ne+=a*Be,be+=a*Re,ve+=a*Ye,me+=a*Xe,a=T[7],Ae+=a*Me,ye+=a*Pe,ge+=a*je,le+=a*$e,ue+=a*Fe,ae+=a*Le,oe+=a*Ke,se+=a*Ge,te+=a*Ve,fe+=a*qe,_e+=a*We,ne+=a*He,be+=a*Be,ve+=a*Re,me+=a*Ye,De+=a*Xe,a=T[8],ye+=a*Me,ge+=a*Pe,le+=a*je,ue+=a*$e,ae+=a*Fe,oe+=a*Le,se+=a*Ke,te+=a*Ge,fe+=a*Ve,_e+=a*qe,ne+=a*We,be+=a*He,ve+=a*Be,me+=a*Re,De+=a*Ye,we+=a*Xe,a=T[9],ge+=a*Me,le+=a*Pe,ue+=a*je,ae+=a*$e,oe+=a*Fe,se+=a*Le,te+=a*Ke,fe+=a*Ge,_e+=a*Ve,ne+=a*qe,be+=a*We,ve+=a*He,me+=a*Be,De+=a*Re,we+=a*Ye,_t+=a*Xe,a=T[10],le+=a*Me,ue+=a*Pe,ae+=a*je,oe+=a*$e,se+=a*Fe,te+=a*Le,fe+=a*Ke,_e+=a*Ge,ne+=a*Ve,be+=a*qe,ve+=a*We,me+=a*He,De+=a*Be,we+=a*Re,_t+=a*Ye,bt+=a*Xe,a=T[11],ue+=a*Me,ae+=a*Pe,oe+=a*je,se+=a*$e,te+=a*Fe,fe+=a*Le,_e+=a*Ke,ne+=a*Ge,be+=a*Ve,ve+=a*qe,me+=a*We,De+=a*He,we+=a*Be,_t+=a*Re,bt+=a*Ye,Ot+=a*Xe,a=T[12],ae+=a*Me,oe+=a*Pe,se+=a*je,te+=a*$e,fe+=a*Fe,_e+=a*Le,ne+=a*Ke,be+=a*Ge,ve+=a*Ve,me+=a*qe,De+=a*We,we+=a*He,_t+=a*Be,bt+=a*Re,Ot+=a*Ye,at+=a*Xe,a=T[13],oe+=a*Me,se+=a*Pe,te+=a*je,fe+=a*$e,_e+=a*Fe,ne+=a*Le,be+=a*Ke,ve+=a*Ge,me+=a*Ve,De+=a*qe,we+=a*We,_t+=a*He,bt+=a*Be,Ot+=a*Re,at+=a*Ye,Mt+=a*Xe,a=T[14],se+=a*Me,te+=a*Pe,fe+=a*je,_e+=a*$e,ne+=a*Fe,be+=a*Le,ve+=a*Ke,me+=a*Ge,De+=a*Ve,we+=a*qe,_t+=a*We,bt+=a*He,Ot+=a*Be,at+=a*Re,Mt+=a*Ye,pr+=a*Xe,a=T[15],te+=a*Me,fe+=a*Pe,_e+=a*je,ne+=a*$e,be+=a*Fe,ve+=a*Le,me+=a*Ke,De+=a*Ge,we+=a*Ve,_t+=a*qe,bt+=a*We,Ot+=a*He,at+=a*Be,Mt+=a*Re,pr+=a*Ye,Hr+=a*Xe,K+=38*fe,q+=38*_e,he+=38*ne,pe+=38*be,de+=38*ve,Ee+=38*me,Ue+=38*De,Ae+=38*we,ye+=38*_t,ge+=38*bt,le+=38*Ot,ue+=38*at,ae+=38*Mt,oe+=38*pr,se+=38*Hr,y=1,a=K+y+65535,y=Math.floor(a/65536),K=a-y*65536,a=q+y+65535,y=Math.floor(a/65536),q=a-y*65536,a=he+y+65535,y=Math.floor(a/65536),he=a-y*65536,a=pe+y+65535,y=Math.floor(a/65536),pe=a-y*65536,a=de+y+65535,y=Math.floor(a/65536),de=a-y*65536,a=Ee+y+65535,y=Math.floor(a/65536),Ee=a-y*65536,a=Ue+y+65535,y=Math.floor(a/65536),Ue=a-y*65536,a=Ae+y+65535,y=Math.floor(a/65536),Ae=a-y*65536,a=ye+y+65535,y=Math.floor(a/65536),ye=a-y*65536,a=ge+y+65535,y=Math.floor(a/65536),ge=a-y*65536,a=le+y+65535,y=Math.floor(a/65536),le=a-y*65536,a=ue+y+65535,y=Math.floor(a/65536),ue=a-y*65536,a=ae+y+65535,y=Math.floor(a/65536),ae=a-y*65536,a=oe+y+65535,y=Math.floor(a/65536),oe=a-y*65536,a=se+y+65535,y=Math.floor(a/65536),se=a-y*65536,a=te+y+65535,y=Math.floor(a/65536),te=a-y*65536,K+=y-1+37*(y-1),y=1,a=K+y+65535,y=Math.floor(a/65536),K=a-y*65536,a=q+y+65535,y=Math.floor(a/65536),q=a-y*65536,a=he+y+65535,y=Math.floor(a/65536),he=a-y*65536,a=pe+y+65535,y=Math.floor(a/65536),pe=a-y*65536,a=de+y+65535,y=Math.floor(a/65536),de=a-y*65536,a=Ee+y+65535,y=Math.floor(a/65536),Ee=a-y*65536,a=Ue+y+65535,y=Math.floor(a/65536),Ue=a-y*65536,a=Ae+y+65535,y=Math.floor(a/65536),Ae=a-y*65536,a=ye+y+65535,y=Math.floor(a/65536),ye=a-y*65536,a=ge+y+65535,y=Math.floor(a/65536),ge=a-y*65536,a=le+y+65535,y=Math.floor(a/65536),le=a-y*65536,a=ue+y+65535,y=Math.floor(a/65536),ue=a-y*65536,a=ae+y+65535,y=Math.floor(a/65536),ae=a-y*65536,a=oe+y+65535,y=Math.floor(a/65536),oe=a-y*65536,a=se+y+65535,y=Math.floor(a/65536),se=a-y*65536,a=te+y+65535,y=Math.floor(a/65536),te=a-y*65536,K+=y-1+37*(y-1),x[0]=K,x[1]=q,x[2]=he,x[3]=pe,x[4]=de,x[5]=Ee,x[6]=Ue,x[7]=Ae,x[8]=ye,x[9]=ge,x[10]=le,x[11]=ue,x[12]=ae,x[13]=oe,x[14]=se,x[15]=te}function l(x,T){o(x,T,T)}function L(x,T){const w=i();let a;for(a=0;a<16;a++)w[a]=T[a];for(a=253;a>=0;a--)l(w,w),a!==2&&a!==4&&o(w,w,T);for(a=0;a<16;a++)x[a]=w[a]}function P(x,T){const w=i();let a;for(a=0;a<16;a++)w[a]=T[a];for(a=250;a>=0;a--)l(w,w),a!==1&&o(w,w,T);for(a=0;a<16;a++)x[a]=w[a]}function H(x,T){const w=i(),a=i(),y=i(),K=i(),q=i(),he=i(),pe=i(),de=i(),Ee=i();d(w,x[1],x[0]),d(Ee,T[1],T[0]),o(w,w,Ee),v(a,x[0],x[1]),v(Ee,T[0],T[1]),o(a,a,Ee),o(y,x[3],T[3]),o(y,y,f),o(K,x[2],T[2]),v(K,K,K),d(q,a,w),d(he,K,y),v(pe,K,y),v(de,a,w),o(x[0],q,he),o(x[1],de,pe),o(x[2],pe,he),o(x[3],q,de)}function G(x,T,w){for(let a=0;a<4;a++)A(x[a],T[a],w)}function J(x,T){const w=i(),a=i(),y=i();L(y,T[2]),o(w,T[0],y),o(a,T[1],y),U(x,a),x[31]^=R(w)<<7}function D(x,T,w){E(x[0],c),E(x[1],u),E(x[2],u),E(x[3],c);for(let a=255;a>=0;--a){const y=w[a/8|0]>>(a&7)&1;G(x,T,y),H(T,x),H(x,x),G(x,T,y)}}function I(x,T){const w=[i(),i(),i(),i()];E(w[0],_),E(w[1],O),E(w[2],u),o(w[3],_,O),D(x,w,T)}function V(x){if(x.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const T=(0,r.hash)(x);T[0]&=248,T[31]&=127,T[31]|=64;const w=new Uint8Array(32),a=[i(),i(),i(),i()];I(a,T),J(w,a);const y=new Uint8Array(64);return y.set(x),y.set(w,32),{publicKey:w,secretKey:y}}t.generateKeyPairFromSeed=V;function F(x){const T=(0,e.randomBytes)(32,x),w=V(T);return(0,n.wipe)(T),w}t.generateKeyPair=F;function M(x){if(x.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(x.subarray(32))}t.extractPublicKeyFromSecretKey=M;const $=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function N(x,T){let w,a,y,K;for(a=63;a>=32;--a){for(w=0,y=a-32,K=a-12;y<K;++y)T[y]+=w-16*T[a]*$[y-(a-32)],w=Math.floor((T[y]+128)/256),T[y]-=w*256;T[y]+=w,T[a]=0}for(w=0,y=0;y<32;y++)T[y]+=w-(T[31]>>4)*$[y],w=T[y]>>8,T[y]&=255;for(y=0;y<32;y++)T[y]-=w*$[y];for(a=0;a<32;a++)T[a+1]+=T[a]>>8,x[a]=T[a]&255}function B(x){const T=new Float64Array(64);for(let w=0;w<64;w++)T[w]=x[w];for(let w=0;w<64;w++)x[w]=0;N(x,T)}function ee(x,T){const w=new Float64Array(64),a=[i(),i(),i(),i()],y=(0,r.hash)(x.subarray(0,32));y[0]&=248,y[31]&=127,y[31]|=64;const K=new Uint8Array(64);K.set(y.subarray(32),32);const q=new r.SHA512;q.update(K.subarray(32)),q.update(T);const he=q.digest();q.clean(),B(he),I(a,he),J(K,a),q.reset(),q.update(K.subarray(0,32)),q.update(x.subarray(32)),q.update(T);const pe=q.digest();B(pe);for(let de=0;de<32;de++)w[de]=he[de];for(let de=0;de<32;de++)for(let Ee=0;Ee<32;Ee++)w[de+Ee]+=pe[de]*y[Ee];return N(K.subarray(32),w),K}t.sign=ee;function z(x,T){const w=i(),a=i(),y=i(),K=i(),q=i(),he=i(),pe=i();return E(x[2],u),b(x[1],T),l(y,x[1]),o(K,y,h),d(y,y,x[2]),v(K,x[2],K),l(q,K),l(he,q),o(pe,he,q),o(w,pe,y),o(w,w,K),P(w,w),o(w,w,y),o(w,w,K),o(w,w,K),o(x[0],w,K),l(a,x[0]),o(a,a,K),S(a,y)&&o(x[0],x[0],p),l(a,x[0]),o(a,a,K),S(a,y)?-1:(R(x[0])===T[31]>>7&&d(x[0],c,x[0]),o(x[3],x[0],x[1]),0)}function Z(x,T,w){const a=new Uint8Array(32),y=[i(),i(),i(),i()],K=[i(),i(),i(),i()];if(w.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(z(K,x))return!1;const q=new r.SHA512;q.update(w.subarray(0,32)),q.update(x),q.update(T);const he=q.digest();return B(he),D(y,K,he),I(K,w.subarray(32)),H(y,K),J(a,y),!W(w,a)}t.verify=Z;function Y(x){let T=[i(),i(),i(),i()];if(z(T,x))throw new Error("Ed25519: invalid public key");let w=i(),a=i(),y=T[1];v(w,u,y),d(a,u,y),L(a,a),o(w,w,a);let K=new Uint8Array(32);return U(K,w),K}t.convertPublicKeyToX25519=Y;function Q(x){const T=(0,r.hash)(x.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const w=new Uint8Array(T.subarray(0,32));return(0,n.wipe)(T),w}t.convertSecretKeyToX25519=Q}(bn);const wf="EdDSA",mf="JWT",ns=".",is="base64url",Df="utf8",Sf="utf8",Of=":",Tf="did",xf="key",ss="base58btc",If="z",Rf="K36",Cf=32;function Dn(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function os(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Dn(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Sn(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=os(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return Dn(r)}function Af(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),c=s.charCodeAt(0);if(r[c]!==255)throw new TypeError(s+" is ambiguous");r[c]=i}var u=t.length,h=t.charAt(0),f=Math.log(u)/Math.log(256),_=Math.log(256)/Math.log(u);function O(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var A=0,U=0,W=0,S=C.length;W!==S&&C[W]===0;)W++,A++;for(var R=(S-W)*_+1>>>0,b=new Uint8Array(R);W!==S;){for(var v=C[W],d=0,o=R-1;(v!==0||d<U)&&o!==-1;o--,d++)v+=256*b[o]>>>0,b[o]=v%u>>>0,v=v/u>>>0;if(v!==0)throw new Error("Non-zero carry");U=d,W++}for(var l=R-U;l!==R&&b[l]===0;)l++;for(var L=h.repeat(A);l<R;++l)L+=t.charAt(b[l]);return L}function p(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var A=0;if(C[A]!==" "){for(var U=0,W=0;C[A]===h;)U++,A++;for(var S=(C.length-A)*f+1>>>0,R=new Uint8Array(S);C[A];){var b=r[C.charCodeAt(A)];if(b===255)return;for(var v=0,d=S-1;(b!==0||v<W)&&d!==-1;d--,v++)b+=u*R[d]>>>0,R[d]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");W=v,A++}if(C[A]!==" "){for(var o=S-W;o!==S&&R[o]===0;)o++;for(var l=new Uint8Array(U+(S-o)),L=U;o!==S;)l[L++]=R[o++];return l}}}function E(C){var A=p(C);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:O,decodeUnsafe:p,decode:E}}var Pf=Af,Lf=Pf;const as=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Nf=t=>new TextEncoder().encode(t),Uf=t=>new TextDecoder().decode(t);class Mf{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class jf{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return cs(this,e)}}class $f{constructor(e){this.decoders=e}or(e){return cs(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const cs=(t,e)=>new $f({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Ff{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Mf(e,r,n),this.decoder=new jf(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Cr=({name:t,prefix:e,encode:r,decode:n})=>new Ff(t,e,r,n),cr=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=Lf(r,e);return Cr({prefix:t,name:e,encode:n,decode:s=>as(i(s))})},Bf=(t,e,r,n)=>{const i={};for(let _=0;_<e.length;++_)i[e[_]]=_;let s=t.length;for(;t[s-1]==="=";)--s;const c=new Uint8Array(s*r/8|0);let u=0,h=0,f=0;for(let _=0;_<s;++_){const O=i[t[_]];if(O===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|O,u+=r,u>=8&&(u-=8,c[f++]=255&h>>u)}if(u>=r||255&h<<8-u)throw new SyntaxError("Unexpected end of data");return c},zf=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",c=0,u=0;for(let h=0;h<t.length;++h)for(u=u<<8|t[h],c+=8;c>r;)c-=r,s+=e[i&u>>c];if(c&&(s+=e[i&u<<r-c]),n)for(;s.length*r&7;)s+="=";return s},Ze=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Cr({prefix:e,name:t,encode(i){return zf(i,n,r)},decode(i){return Bf(i,n,r,t)}}),Hf=Cr({prefix:"\0",name:"identity",encode:t=>Uf(t),decode:t=>Nf(t)});var Kf=Object.freeze({__proto__:null,identity:Hf});const Gf=Ze({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Vf=Object.freeze({__proto__:null,base2:Gf});const qf=Ze({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Wf=Object.freeze({__proto__:null,base8:qf});const Yf=cr({prefix:"9",name:"base10",alphabet:"0123456789"});var Xf=Object.freeze({__proto__:null,base10:Yf});const kf=Ze({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Jf=Ze({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Zf=Object.freeze({__proto__:null,base16:kf,base16upper:Jf});const Qf=Ze({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),eh=Ze({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),th=Ze({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rh=Ze({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),nh=Ze({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ih=Ze({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),sh=Ze({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),oh=Ze({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ah=Ze({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ch=Object.freeze({__proto__:null,base32:Qf,base32upper:eh,base32pad:th,base32padupper:rh,base32hex:nh,base32hexupper:ih,base32hexpad:sh,base32hexpadupper:oh,base32z:ah});const uh=cr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),fh=cr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var hh=Object.freeze({__proto__:null,base36:uh,base36upper:fh});const lh=cr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),dh=cr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var gh=Object.freeze({__proto__:null,base58btc:lh,base58flickr:dh});const _h=Ze({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),yh=Ze({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ph=Ze({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),bh=Ze({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var vh=Object.freeze({__proto__:null,base64:_h,base64pad:yh,base64url:ph,base64urlpad:bh});const us=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Eh=us.reduce((t,e,r)=>(t[r]=e,t),[]),wh=us.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function mh(t){return t.reduce((e,r)=>(e+=Eh[r],e),"")}function Dh(t){const e=[];for(const r of t){const n=wh[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const Sh=Cr({prefix:"\u{1F680}",name:"base256emoji",encode:mh,decode:Dh});var Oh=Object.freeze({__proto__:null,base256emoji:Sh}),Th=hs,fs=128,xh=127,Ih=~xh,Rh=Math.pow(2,31);function hs(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Rh;)e[r++]=t&255|fs,t/=128;for(;t&Ih;)e[r++]=t&255|fs,t>>>=7;return e[r]=t|0,hs.bytes=r-n+1,e}var Ch=On,Ah=128,ls=127;function On(t,n){var r=0,n=n||0,i=0,s=n,c,u=t.length;do{if(s>=u)throw On.bytes=0,new RangeError("Could not decode varint");c=t[s++],r+=i<28?(c&ls)<<i:(c&ls)*Math.pow(2,i),i+=7}while(c>=Ah);return On.bytes=s-n,r}var Ph=Math.pow(2,7),Lh=Math.pow(2,14),Nh=Math.pow(2,21),Uh=Math.pow(2,28),Mh=Math.pow(2,35),jh=Math.pow(2,42),$h=Math.pow(2,49),Fh=Math.pow(2,56),Bh=Math.pow(2,63),zh=function(t){return t<Ph?1:t<Lh?2:t<Nh?3:t<Uh?4:t<Mh?5:t<jh?6:t<$h?7:t<Fh?8:t<Bh?9:10},Hh={encode:Th,decode:Ch,encodingLength:zh},ds=Hh;const gs=(t,e,r=0)=>(ds.encode(t,e,r),e),_s=t=>ds.encodingLength(t),Tn=(t,e)=>{const r=e.byteLength,n=_s(t),i=n+_s(r),s=new Uint8Array(i+r);return gs(t,s,0),gs(r,s,n),s.set(e,i),new Kh(t,r,e,s)};class Kh{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const ys=({name:t,code:e,encode:r})=>new Gh(t,e,r);class Gh{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Tn(this.code,r):r.then(n=>Tn(this.code,n))}else throw Error("Unknown type, must be binary type")}}const ps=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Vh=ys({name:"sha2-256",code:18,encode:ps("SHA-256")}),qh=ys({name:"sha2-512",code:19,encode:ps("SHA-512")});var Wh=Object.freeze({__proto__:null,sha256:Vh,sha512:qh});const bs=0,Yh="identity",vs=as;var Xh=Object.freeze({__proto__:null,identity:{code:bs,name:Yh,encode:vs,digest:t=>Tn(bs,vs(t))}});new TextEncoder,new TextDecoder;const Es={...Kf,...Vf,...Wf,...Xf,...Zf,...ch,...hh,...gh,...vh,...Oh};({...Wh,...Xh});function ws(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const ms=ws("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),xn=ws("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=os(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ds={utf8:ms,"utf-8":ms,hex:Es.base16,latin1:xn,ascii:xn,binary:xn,...Es};function nt(t,e="utf8"){const r=Ds[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function it(t,e="utf8"){const r=Ds[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Dn(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Ar(t){return nt(it(pn(t),Df),is)}function Ss(t){const e=it(Rf,ss),r=If+nt(Sn([e,t]),ss);return[Tf,xf,r].join(Of)}function kh(t){return nt(t,is)}function Jh(t){return it([Ar(t.header),Ar(t.payload)].join(ns),Sf)}function Zh(t){return[Ar(t.header),Ar(t.payload),kh(t.signature)].join(ns)}function Os(t=Kt.randomBytes(Cf)){return bn.generateKeyPairFromSeed(t)}async function Qh(t,e,r,n,i=ce.fromMiliseconds(Date.now())){const s={alg:wf,typ:mf},c=Ss(n.publicKey),u=i+r,h={iss:c,sub:t,aud:e,iat:i,exp:u},f=Jh({header:s,payload:h}),_=bn.sign(n.secretKey,f);return Zh({header:s,payload:h,signature:_})}var In={},Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});var et=re,Rn=ot,el=20;function tl(t,e,r){for(var n=1634760805,i=857760878,s=2036477234,c=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],f=r[11]<<24|r[10]<<16|r[9]<<8|r[8],_=r[15]<<24|r[14]<<16|r[13]<<8|r[12],O=r[19]<<24|r[18]<<16|r[17]<<8|r[16],p=r[23]<<24|r[22]<<16|r[21]<<8|r[20],E=r[27]<<24|r[26]<<16|r[25]<<8|r[24],C=r[31]<<24|r[30]<<16|r[29]<<8|r[28],A=e[3]<<24|e[2]<<16|e[1]<<8|e[0],U=e[7]<<24|e[6]<<16|e[5]<<8|e[4],W=e[11]<<24|e[10]<<16|e[9]<<8|e[8],S=e[15]<<24|e[14]<<16|e[13]<<8|e[12],R=n,b=i,v=s,d=c,o=u,l=h,L=f,P=_,H=O,G=p,J=E,D=C,I=A,V=U,F=W,M=S,$=0;$<el;$+=2)R=R+o|0,I^=R,I=I>>>32-16|I<<16,H=H+I|0,o^=H,o=o>>>32-12|o<<12,b=b+l|0,V^=b,V=V>>>32-16|V<<16,G=G+V|0,l^=G,l=l>>>32-12|l<<12,v=v+L|0,F^=v,F=F>>>32-16|F<<16,J=J+F|0,L^=J,L=L>>>32-12|L<<12,d=d+P|0,M^=d,M=M>>>32-16|M<<16,D=D+M|0,P^=D,P=P>>>32-12|P<<12,v=v+L|0,F^=v,F=F>>>32-8|F<<8,J=J+F|0,L^=J,L=L>>>32-7|L<<7,d=d+P|0,M^=d,M=M>>>32-8|M<<8,D=D+M|0,P^=D,P=P>>>32-7|P<<7,b=b+l|0,V^=b,V=V>>>32-8|V<<8,G=G+V|0,l^=G,l=l>>>32-7|l<<7,R=R+o|0,I^=R,I=I>>>32-8|I<<8,H=H+I|0,o^=H,o=o>>>32-7|o<<7,R=R+l|0,M^=R,M=M>>>32-16|M<<16,J=J+M|0,l^=J,l=l>>>32-12|l<<12,b=b+L|0,I^=b,I=I>>>32-16|I<<16,D=D+I|0,L^=D,L=L>>>32-12|L<<12,v=v+P|0,V^=v,V=V>>>32-16|V<<16,H=H+V|0,P^=H,P=P>>>32-12|P<<12,d=d+o|0,F^=d,F=F>>>32-16|F<<16,G=G+F|0,o^=G,o=o>>>32-12|o<<12,v=v+P|0,V^=v,V=V>>>32-8|V<<8,H=H+V|0,P^=H,P=P>>>32-7|P<<7,d=d+o|0,F^=d,F=F>>>32-8|F<<8,G=G+F|0,o^=G,o=o>>>32-7|o<<7,b=b+L|0,I^=b,I=I>>>32-8|I<<8,D=D+I|0,L^=D,L=L>>>32-7|L<<7,R=R+l|0,M^=R,M=M>>>32-8|M<<8,J=J+M|0,l^=J,l=l>>>32-7|l<<7;et.writeUint32LE(R+n|0,t,0),et.writeUint32LE(b+i|0,t,4),et.writeUint32LE(v+s|0,t,8),et.writeUint32LE(d+c|0,t,12),et.writeUint32LE(o+u|0,t,16),et.writeUint32LE(l+h|0,t,20),et.writeUint32LE(L+f|0,t,24),et.writeUint32LE(P+_|0,t,28),et.writeUint32LE(H+O|0,t,32),et.writeUint32LE(G+p|0,t,36),et.writeUint32LE(J+E|0,t,40),et.writeUint32LE(D+C|0,t,44),et.writeUint32LE(I+A|0,t,48),et.writeUint32LE(V+U|0,t,52),et.writeUint32LE(F+W|0,t,56),et.writeUint32LE(M+S|0,t,60)}function Ts(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,c;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),c=s.length-e.length,s.set(e,c)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,c=i}for(var u=new Uint8Array(64),h=0;h<r.length;h+=64){tl(u,s,t);for(var f=h;f<h+64&&f<r.length;f++)n[f]=r[f]^u[f-h];nl(s,0,c)}return Rn.wipe(u),i===0&&Rn.wipe(s),n}Pr.streamXOR=Ts;function rl(t,e,r,n){return n===void 0&&(n=0),Rn.wipe(r),Ts(t,e,r,r,n)}Pr.stream=rl;function nl(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var xs={},St={};Object.defineProperty(St,"__esModule",{value:!0});function il(t,e,r){return~(t-1)&e|t-1&r}St.select=il;function sl(t,e){return(t|0)-(e|0)-1>>>31&1}St.lessOrEqual=sl;function Is(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}St.compare=Is;function ol(t,e){return t.length===0||e.length===0?!1:Is(t,e)!==0}St.equal=ol,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=St,r=ot;t.DIGEST_LENGTH=16;var n=function(){function c(u){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=u[0]|u[1]<<8;this._r[0]=h&8191;var f=u[2]|u[3]<<8;this._r[1]=(h>>>13|f<<3)&8191;var _=u[4]|u[5]<<8;this._r[2]=(f>>>10|_<<6)&7939;var O=u[6]|u[7]<<8;this._r[3]=(_>>>7|O<<9)&8191;var p=u[8]|u[9]<<8;this._r[4]=(O>>>4|p<<12)&255,this._r[5]=p>>>1&8190;var E=u[10]|u[11]<<8;this._r[6]=(p>>>14|E<<2)&8191;var C=u[12]|u[13]<<8;this._r[7]=(E>>>11|C<<5)&8065;var A=u[14]|u[15]<<8;this._r[8]=(C>>>8|A<<8)&8191,this._r[9]=A>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return c.prototype._blocks=function(u,h,f){for(var _=this._fin?0:2048,O=this._h[0],p=this._h[1],E=this._h[2],C=this._h[3],A=this._h[4],U=this._h[5],W=this._h[6],S=this._h[7],R=this._h[8],b=this._h[9],v=this._r[0],d=this._r[1],o=this._r[2],l=this._r[3],L=this._r[4],P=this._r[5],H=this._r[6],G=this._r[7],J=this._r[8],D=this._r[9];f>=16;){var I=u[h+0]|u[h+1]<<8;O+=I&8191;var V=u[h+2]|u[h+3]<<8;p+=(I>>>13|V<<3)&8191;var F=u[h+4]|u[h+5]<<8;E+=(V>>>10|F<<6)&8191;var M=u[h+6]|u[h+7]<<8;C+=(F>>>7|M<<9)&8191;var $=u[h+8]|u[h+9]<<8;A+=(M>>>4|$<<12)&8191,U+=$>>>1&8191;var N=u[h+10]|u[h+11]<<8;W+=($>>>14|N<<2)&8191;var B=u[h+12]|u[h+13]<<8;S+=(N>>>11|B<<5)&8191;var ee=u[h+14]|u[h+15]<<8;R+=(B>>>8|ee<<8)&8191,b+=ee>>>5|_;var z=0,Z=z;Z+=O*v,Z+=p*(5*D),Z+=E*(5*J),Z+=C*(5*G),Z+=A*(5*H),z=Z>>>13,Z&=8191,Z+=U*(5*P),Z+=W*(5*L),Z+=S*(5*l),Z+=R*(5*o),Z+=b*(5*d),z+=Z>>>13,Z&=8191;var Y=z;Y+=O*d,Y+=p*v,Y+=E*(5*D),Y+=C*(5*J),Y+=A*(5*G),z=Y>>>13,Y&=8191,Y+=U*(5*H),Y+=W*(5*P),Y+=S*(5*L),Y+=R*(5*l),Y+=b*(5*o),z+=Y>>>13,Y&=8191;var Q=z;Q+=O*o,Q+=p*d,Q+=E*v,Q+=C*(5*D),Q+=A*(5*J),z=Q>>>13,Q&=8191,Q+=U*(5*G),Q+=W*(5*H),Q+=S*(5*P),Q+=R*(5*L),Q+=b*(5*l),z+=Q>>>13,Q&=8191;var x=z;x+=O*l,x+=p*o,x+=E*d,x+=C*v,x+=A*(5*D),z=x>>>13,x&=8191,x+=U*(5*J),x+=W*(5*G),x+=S*(5*H),x+=R*(5*P),x+=b*(5*L),z+=x>>>13,x&=8191;var T=z;T+=O*L,T+=p*l,T+=E*o,T+=C*d,T+=A*v,z=T>>>13,T&=8191,T+=U*(5*D),T+=W*(5*J),T+=S*(5*G),T+=R*(5*H),T+=b*(5*P),z+=T>>>13,T&=8191;var w=z;w+=O*P,w+=p*L,w+=E*l,w+=C*o,w+=A*d,z=w>>>13,w&=8191,w+=U*v,w+=W*(5*D),w+=S*(5*J),w+=R*(5*G),w+=b*(5*H),z+=w>>>13,w&=8191;var a=z;a+=O*H,a+=p*P,a+=E*L,a+=C*l,a+=A*o,z=a>>>13,a&=8191,a+=U*d,a+=W*v,a+=S*(5*D),a+=R*(5*J),a+=b*(5*G),z+=a>>>13,a&=8191;var y=z;y+=O*G,y+=p*H,y+=E*P,y+=C*L,y+=A*l,z=y>>>13,y&=8191,y+=U*o,y+=W*d,y+=S*v,y+=R*(5*D),y+=b*(5*J),z+=y>>>13,y&=8191;var K=z;K+=O*J,K+=p*G,K+=E*H,K+=C*P,K+=A*L,z=K>>>13,K&=8191,K+=U*l,K+=W*o,K+=S*d,K+=R*v,K+=b*(5*D),z+=K>>>13,K&=8191;var q=z;q+=O*D,q+=p*J,q+=E*G,q+=C*H,q+=A*P,z=q>>>13,q&=8191,q+=U*L,q+=W*l,q+=S*o,q+=R*d,q+=b*v,z+=q>>>13,q&=8191,z=(z<<2)+z|0,z=z+Z|0,Z=z&8191,z=z>>>13,Y+=z,O=Z,p=Y,E=Q,C=x,A=T,U=w,W=a,S=y,R=K,b=q,h+=16,f-=16}this._h[0]=O,this._h[1]=p,this._h[2]=E,this._h[3]=C,this._h[4]=A,this._h[5]=U,this._h[6]=W,this._h[7]=S,this._h[8]=R,this._h[9]=b},c.prototype.finish=function(u,h){h===void 0&&(h=0);var f=new Uint16Array(10),_,O,p,E;if(this._leftover){for(E=this._leftover,this._buffer[E++]=1;E<16;E++)this._buffer[E]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(_=this._h[1]>>>13,this._h[1]&=8191,E=2;E<10;E++)this._h[E]+=_,_=this._h[E]>>>13,this._h[E]&=8191;for(this._h[0]+=_*5,_=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=_,_=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=_,f[0]=this._h[0]+5,_=f[0]>>>13,f[0]&=8191,E=1;E<10;E++)f[E]=this._h[E]+_,_=f[E]>>>13,f[E]&=8191;for(f[9]-=8192,O=(_^1)-1,E=0;E<10;E++)f[E]&=O;for(O=~O,E=0;E<10;E++)this._h[E]=this._h[E]&O|f[E];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,p=this._h[0]+this._pad[0],this._h[0]=p&65535,E=1;E<8;E++)p=(this._h[E]+this._pad[E]|0)+(p>>>16)|0,this._h[E]=p&65535;return u[h+0]=this._h[0]>>>0,u[h+1]=this._h[0]>>>8,u[h+2]=this._h[1]>>>0,u[h+3]=this._h[1]>>>8,u[h+4]=this._h[2]>>>0,u[h+5]=this._h[2]>>>8,u[h+6]=this._h[3]>>>0,u[h+7]=this._h[3]>>>8,u[h+8]=this._h[4]>>>0,u[h+9]=this._h[4]>>>8,u[h+10]=this._h[5]>>>0,u[h+11]=this._h[5]>>>8,u[h+12]=this._h[6]>>>0,u[h+13]=this._h[6]>>>8,u[h+14]=this._h[7]>>>0,u[h+15]=this._h[7]>>>8,this._finished=!0,this},c.prototype.update=function(u){var h=0,f=u.length,_;if(this._leftover){_=16-this._leftover,_>f&&(_=f);for(var O=0;O<_;O++)this._buffer[this._leftover+O]=u[h+O];if(f-=_,h+=_,this._leftover+=_,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(f>=16&&(_=f-f%16,this._blocks(u,h,_),h+=_,f-=_),f){for(var O=0;O<f;O++)this._buffer[this._leftover+O]=u[h+O];this._leftover+=f}return this},c.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},c.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},c}();t.Poly1305=n;function i(c,u){var h=new n(c);h.update(u);var f=h.digest();return h.clean(),f}t.oneTimeAuth=i;function s(c,u){return c.length!==t.DIGEST_LENGTH||u.length!==t.DIGEST_LENGTH?!1:e.equal(c,u)}t.equal=s}(xs),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Pr,r=xs,n=ot,i=re,s=St;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var c=new Uint8Array(16),u=function(){function h(f){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,f.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(f)}return h.prototype.seal=function(f,_,O,p){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var E=new Uint8Array(16);E.set(f,E.length-f.length);var C=new Uint8Array(32);e.stream(this._key,E,C,4);var A=_.length+this.tagLength,U;if(p){if(p.length!==A)throw new Error("ChaCha20Poly1305: incorrect destination length");U=p}else U=new Uint8Array(A);return e.streamXOR(this._key,E,_,U,4),this._authenticate(U.subarray(U.length-this.tagLength,U.length),C,U.subarray(0,U.length-this.tagLength),O),n.wipe(E),U},h.prototype.open=function(f,_,O,p){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(_.length<this.tagLength)return null;var E=new Uint8Array(16);E.set(f,E.length-f.length);var C=new Uint8Array(32);e.stream(this._key,E,C,4);var A=new Uint8Array(this.tagLength);if(this._authenticate(A,C,_.subarray(0,_.length-this.tagLength),O),!s.equal(A,_.subarray(_.length-this.tagLength,_.length)))return null;var U=_.length-this.tagLength,W;if(p){if(p.length!==U)throw new Error("ChaCha20Poly1305: incorrect destination length");W=p}else W=new Uint8Array(U);return e.streamXOR(this._key,E,_.subarray(0,_.length-this.tagLength),W,4),n.wipe(E),W},h.prototype.clean=function(){return n.wipe(this._key),this},h.prototype._authenticate=function(f,_,O,p){var E=new r.Poly1305(_);p&&(E.update(p),p.length%16>0&&E.update(c.subarray(p.length%16))),E.update(O),O.length%16>0&&E.update(c.subarray(O.length%16));var C=new Uint8Array(8);p&&i.writeUint64LE(p.length,C),E.update(C),i.writeUint64LE(O.length,C),E.update(C);for(var A=E.digest(),U=0;U<A.length;U++)f[U]=A[U];E.clean(),n.wipe(A),n.wipe(C)},h}();t.ChaCha20Poly1305=u}(In);var Rs={},ur={},Cn={};Object.defineProperty(Cn,"__esModule",{value:!0});function al(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}Cn.isSerializableHash=al,Object.defineProperty(ur,"__esModule",{value:!0});var pt=Cn,cl=St,ul=ot,Cs=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),pt.isSerializableHash(this._inner)&&pt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),ul.wipe(n)}return t.prototype.reset=function(){if(!pt.isSerializableHash(this._inner)||!pt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){pt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),pt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!pt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!pt.isSerializableHash(this._inner)||!pt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!pt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();ur.HMAC=Cs;function fl(t,e,r){var n=new Cs(t,e);n.update(r);var i=n.digest();return n.clean(),i}ur.hmac=fl,ur.equal=cl.equal,Object.defineProperty(Rs,"__esModule",{value:!0});var As=ur,Ps=ot,hl=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=As.hmac(this._hash,n,r);this._hmac=new As.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),Ps.wipe(this._buffer),Ps.wipe(this._counter),this._bufpos=0},t}(),ll=Rs.HKDF=hl,Lr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=ot;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var n=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},u.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var _=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&f>0;)this._buffer[this._bufferLength++]=h[_++],f--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(_=s(this._temp,this._state,h,_,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[_++],f--;return this},u.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,_=this._bufferLength,O=f/536870912|0,p=f<<3,E=f%64<56?64:128;this._buffer[_]=128;for(var C=_+1;C<E-8;C++)this._buffer[C]=0;e.writeUint32BE(O,this._buffer,E-8),e.writeUint32BE(p,this._buffer,E-4),s(this._temp,this._state,this._buffer,0,E),this._finished=!0}for(var C=0;C<this.digestLength/4;C++)e.writeUint32BE(this._state[C],h,C*4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();t.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(u,h,f,_,O){for(;O>=64;){for(var p=h[0],E=h[1],C=h[2],A=h[3],U=h[4],W=h[5],S=h[6],R=h[7],b=0;b<16;b++){var v=_+b*4;u[b]=e.readUint32BE(f,v)}for(var b=16;b<64;b++){var d=u[b-2],o=(d>>>17|d<<32-17)^(d>>>19|d<<32-19)^d>>>10;d=u[b-15];var l=(d>>>7|d<<32-7)^(d>>>18|d<<32-18)^d>>>3;u[b]=(o+u[b-7]|0)+(l+u[b-16]|0)}for(var b=0;b<64;b++){var o=(((U>>>6|U<<26)^(U>>>11|U<<21)^(U>>>25|U<<7))+(U&W^~U&S)|0)+(R+(i[b]+u[b]|0)|0)|0,l=((p>>>2|p<<32-2)^(p>>>13|p<<32-13)^(p>>>22|p<<32-22))+(p&E^p&C^E&C)|0;R=S,S=W,W=U,U=A+o|0,A=C,C=E,E=p,p=o+l|0}h[0]+=p,h[1]+=E,h[2]+=C,h[3]+=A,h[4]+=U,h[5]+=W,h[6]+=S,h[7]+=R,_+=64,O-=64}return _}function c(u){var h=new n;h.update(u);var f=h.digest();return h.clean(),f}t.hash=c})(Lr);var An={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=Kt,r=ot;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function n(b){const v=new Float64Array(16);if(b)for(let d=0;d<b.length;d++)v[d]=b[d];return v}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function c(b){let v=1;for(let d=0;d<16;d++){let o=b[d]+v+65535;v=Math.floor(o/65536),b[d]=o-v*65536}b[0]+=v-1+37*(v-1)}function u(b,v,d){const o=~(d-1);for(let l=0;l<16;l++){const L=o&(b[l]^v[l]);b[l]^=L,v[l]^=L}}function h(b,v){const d=n(),o=n();for(let l=0;l<16;l++)o[l]=v[l];c(o),c(o),c(o);for(let l=0;l<2;l++){d[0]=o[0]-65517;for(let P=1;P<15;P++)d[P]=o[P]-65535-(d[P-1]>>16&1),d[P-1]&=65535;d[15]=o[15]-32767-(d[14]>>16&1);const L=d[15]>>16&1;d[14]&=65535,u(o,d,1-L)}for(let l=0;l<16;l++)b[2*l]=o[l]&255,b[2*l+1]=o[l]>>8}function f(b,v){for(let d=0;d<16;d++)b[d]=v[2*d]+(v[2*d+1]<<8);b[15]&=32767}function _(b,v,d){for(let o=0;o<16;o++)b[o]=v[o]+d[o]}function O(b,v,d){for(let o=0;o<16;o++)b[o]=v[o]-d[o]}function p(b,v,d){let o,l,L=0,P=0,H=0,G=0,J=0,D=0,I=0,V=0,F=0,M=0,$=0,N=0,B=0,ee=0,z=0,Z=0,Y=0,Q=0,x=0,T=0,w=0,a=0,y=0,K=0,q=0,he=0,pe=0,de=0,Ee=0,Ue=0,Ae=0,ye=d[0],ge=d[1],le=d[2],ue=d[3],ae=d[4],oe=d[5],se=d[6],te=d[7],fe=d[8],_e=d[9],ne=d[10],be=d[11],ve=d[12],me=d[13],De=d[14],we=d[15];o=v[0],L+=o*ye,P+=o*ge,H+=o*le,G+=o*ue,J+=o*ae,D+=o*oe,I+=o*se,V+=o*te,F+=o*fe,M+=o*_e,$+=o*ne,N+=o*be,B+=o*ve,ee+=o*me,z+=o*De,Z+=o*we,o=v[1],P+=o*ye,H+=o*ge,G+=o*le,J+=o*ue,D+=o*ae,I+=o*oe,V+=o*se,F+=o*te,M+=o*fe,$+=o*_e,N+=o*ne,B+=o*be,ee+=o*ve,z+=o*me,Z+=o*De,Y+=o*we,o=v[2],H+=o*ye,G+=o*ge,J+=o*le,D+=o*ue,I+=o*ae,V+=o*oe,F+=o*se,M+=o*te,$+=o*fe,N+=o*_e,B+=o*ne,ee+=o*be,z+=o*ve,Z+=o*me,Y+=o*De,Q+=o*we,o=v[3],G+=o*ye,J+=o*ge,D+=o*le,I+=o*ue,V+=o*ae,F+=o*oe,M+=o*se,$+=o*te,N+=o*fe,B+=o*_e,ee+=o*ne,z+=o*be,Z+=o*ve,Y+=o*me,Q+=o*De,x+=o*we,o=v[4],J+=o*ye,D+=o*ge,I+=o*le,V+=o*ue,F+=o*ae,M+=o*oe,$+=o*se,N+=o*te,B+=o*fe,ee+=o*_e,z+=o*ne,Z+=o*be,Y+=o*ve,Q+=o*me,x+=o*De,T+=o*we,o=v[5],D+=o*ye,I+=o*ge,V+=o*le,F+=o*ue,M+=o*ae,$+=o*oe,N+=o*se,B+=o*te,ee+=o*fe,z+=o*_e,Z+=o*ne,Y+=o*be,Q+=o*ve,x+=o*me,T+=o*De,w+=o*we,o=v[6],I+=o*ye,V+=o*ge,F+=o*le,M+=o*ue,$+=o*ae,N+=o*oe,B+=o*se,ee+=o*te,z+=o*fe,Z+=o*_e,Y+=o*ne,Q+=o*be,x+=o*ve,T+=o*me,w+=o*De,a+=o*we,o=v[7],V+=o*ye,F+=o*ge,M+=o*le,$+=o*ue,N+=o*ae,B+=o*oe,ee+=o*se,z+=o*te,Z+=o*fe,Y+=o*_e,Q+=o*ne,x+=o*be,T+=o*ve,w+=o*me,a+=o*De,y+=o*we,o=v[8],F+=o*ye,M+=o*ge,$+=o*le,N+=o*ue,B+=o*ae,ee+=o*oe,z+=o*se,Z+=o*te,Y+=o*fe,Q+=o*_e,x+=o*ne,T+=o*be,w+=o*ve,a+=o*me,y+=o*De,K+=o*we,o=v[9],M+=o*ye,$+=o*ge,N+=o*le,B+=o*ue,ee+=o*ae,z+=o*oe,Z+=o*se,Y+=o*te,Q+=o*fe,x+=o*_e,T+=o*ne,w+=o*be,a+=o*ve,y+=o*me,K+=o*De,q+=o*we,o=v[10],$+=o*ye,N+=o*ge,B+=o*le,ee+=o*ue,z+=o*ae,Z+=o*oe,Y+=o*se,Q+=o*te,x+=o*fe,T+=o*_e,w+=o*ne,a+=o*be,y+=o*ve,K+=o*me,q+=o*De,he+=o*we,o=v[11],N+=o*ye,B+=o*ge,ee+=o*le,z+=o*ue,Z+=o*ae,Y+=o*oe,Q+=o*se,x+=o*te,T+=o*fe,w+=o*_e,a+=o*ne,y+=o*be,K+=o*ve,q+=o*me,he+=o*De,pe+=o*we,o=v[12],B+=o*ye,ee+=o*ge,z+=o*le,Z+=o*ue,Y+=o*ae,Q+=o*oe,x+=o*se,T+=o*te,w+=o*fe,a+=o*_e,y+=o*ne,K+=o*be,q+=o*ve,he+=o*me,pe+=o*De,de+=o*we,o=v[13],ee+=o*ye,z+=o*ge,Z+=o*le,Y+=o*ue,Q+=o*ae,x+=o*oe,T+=o*se,w+=o*te,a+=o*fe,y+=o*_e,K+=o*ne,q+=o*be,he+=o*ve,pe+=o*me,de+=o*De,Ee+=o*we,o=v[14],z+=o*ye,Z+=o*ge,Y+=o*le,Q+=o*ue,x+=o*ae,T+=o*oe,w+=o*se,a+=o*te,y+=o*fe,K+=o*_e,q+=o*ne,he+=o*be,pe+=o*ve,de+=o*me,Ee+=o*De,Ue+=o*we,o=v[15],Z+=o*ye,Y+=o*ge,Q+=o*le,x+=o*ue,T+=o*ae,w+=o*oe,a+=o*se,y+=o*te,K+=o*fe,q+=o*_e,he+=o*ne,pe+=o*be,de+=o*ve,Ee+=o*me,Ue+=o*De,Ae+=o*we,L+=38*Y,P+=38*Q,H+=38*x,G+=38*T,J+=38*w,D+=38*a,I+=38*y,V+=38*K,F+=38*q,M+=38*he,$+=38*pe,N+=38*de,B+=38*Ee,ee+=38*Ue,z+=38*Ae,l=1,o=L+l+65535,l=Math.floor(o/65536),L=o-l*65536,o=P+l+65535,l=Math.floor(o/65536),P=o-l*65536,o=H+l+65535,l=Math.floor(o/65536),H=o-l*65536,o=G+l+65535,l=Math.floor(o/65536),G=o-l*65536,o=J+l+65535,l=Math.floor(o/65536),J=o-l*65536,o=D+l+65535,l=Math.floor(o/65536),D=o-l*65536,o=I+l+65535,l=Math.floor(o/65536),I=o-l*65536,o=V+l+65535,l=Math.floor(o/65536),V=o-l*65536,o=F+l+65535,l=Math.floor(o/65536),F=o-l*65536,o=M+l+65535,l=Math.floor(o/65536),M=o-l*65536,o=$+l+65535,l=Math.floor(o/65536),$=o-l*65536,o=N+l+65535,l=Math.floor(o/65536),N=o-l*65536,o=B+l+65535,l=Math.floor(o/65536),B=o-l*65536,o=ee+l+65535,l=Math.floor(o/65536),ee=o-l*65536,o=z+l+65535,l=Math.floor(o/65536),z=o-l*65536,o=Z+l+65535,l=Math.floor(o/65536),Z=o-l*65536,L+=l-1+37*(l-1),l=1,o=L+l+65535,l=Math.floor(o/65536),L=o-l*65536,o=P+l+65535,l=Math.floor(o/65536),P=o-l*65536,o=H+l+65535,l=Math.floor(o/65536),H=o-l*65536,o=G+l+65535,l=Math.floor(o/65536),G=o-l*65536,o=J+l+65535,l=Math.floor(o/65536),J=o-l*65536,o=D+l+65535,l=Math.floor(o/65536),D=o-l*65536,o=I+l+65535,l=Math.floor(o/65536),I=o-l*65536,o=V+l+65535,l=Math.floor(o/65536),V=o-l*65536,o=F+l+65535,l=Math.floor(o/65536),F=o-l*65536,o=M+l+65535,l=Math.floor(o/65536),M=o-l*65536,o=$+l+65535,l=Math.floor(o/65536),$=o-l*65536,o=N+l+65535,l=Math.floor(o/65536),N=o-l*65536,o=B+l+65535,l=Math.floor(o/65536),B=o-l*65536,o=ee+l+65535,l=Math.floor(o/65536),ee=o-l*65536,o=z+l+65535,l=Math.floor(o/65536),z=o-l*65536,o=Z+l+65535,l=Math.floor(o/65536),Z=o-l*65536,L+=l-1+37*(l-1),b[0]=L,b[1]=P,b[2]=H,b[3]=G,b[4]=J,b[5]=D,b[6]=I,b[7]=V,b[8]=F,b[9]=M,b[10]=$,b[11]=N,b[12]=B,b[13]=ee,b[14]=z,b[15]=Z}function E(b,v){p(b,v,v)}function C(b,v){const d=n();for(let o=0;o<16;o++)d[o]=v[o];for(let o=253;o>=0;o--)E(d,d),o!==2&&o!==4&&p(d,d,v);for(let o=0;o<16;o++)b[o]=d[o]}function A(b,v){const d=new Uint8Array(32),o=new Float64Array(80),l=n(),L=n(),P=n(),H=n(),G=n(),J=n();for(let F=0;F<31;F++)d[F]=b[F];d[31]=b[31]&127|64,d[0]&=248,f(o,v);for(let F=0;F<16;F++)L[F]=o[F];l[0]=H[0]=1;for(let F=254;F>=0;--F){const M=d[F>>>3]>>>(F&7)&1;u(l,L,M),u(P,H,M),_(G,l,P),O(l,l,P),_(P,L,H),O(L,L,H),E(H,G),E(J,l),p(l,P,l),p(P,L,G),_(G,l,P),O(l,l,P),E(L,l),O(P,H,J),p(l,P,s),_(l,l,H),p(P,P,l),p(l,H,J),p(H,L,o),E(L,G),u(l,L,M),u(P,H,M)}for(let F=0;F<16;F++)o[F+16]=l[F],o[F+32]=P[F],o[F+48]=L[F],o[F+64]=H[F];const D=o.subarray(32),I=o.subarray(16);C(D,D),p(I,I,D);const V=new Uint8Array(32);return h(V,I),V}t.scalarMult=A;function U(b){return A(b,i)}t.scalarMultBase=U;function W(b){if(b.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const v=new Uint8Array(b);return{publicKey:U(v),secretKey:v}}t.generateKeyPairFromSeed=W;function S(b){const v=(0,e.randomBytes)(32,b),d=W(v);return(0,r.wipe)(v),d}t.generateKeyPair=S;function R(b,v,d=!1){if(b.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(v.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=A(b,v);if(d){let l=0;for(let L=0;L<o.length;L++)l|=o[L];if(l===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=R})(An);var Ls=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},dl=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),gl=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),_l=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),yl=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),pl=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),bl=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,vl=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ns=3,El=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",bl]],Us=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function wl(t){return t?Ms(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new pl:typeof navigator<"u"?Ms(navigator.userAgent):Sl()}function ml(t){return t!==""&&El.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function Ms(t){var e=ml(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new yl;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<Ns&&(i=Ls(Ls([],i,!0),Ol(Ns-i.length),!0)):i=[];var s=i.join("."),c=Dl(t),u=vl.exec(t);return u&&u[1]?new _l(r,s,c,u[1]):new dl(r,s,c)}function Dl(t){for(var e=0,r=Us.length;e<r;e++){var n=Us[e],i=n[0],s=n[1],c=s.exec(t);if(c)return i}return null}function Sl(){var t=typeof process<"u"&&process.version;return t?new gl(process.version.slice(1)):null}function Ol(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Te={};Object.defineProperty(Te,"__esModule",{value:!0}),Te.getLocalStorage=Te.getLocalStorageOrThrow=Te.getCrypto=Te.getCryptoOrThrow=$s=Te.getLocation=Te.getLocationOrThrow=Pn=Te.getNavigator=Te.getNavigatorOrThrow=js=Te.getDocument=Te.getDocumentOrThrow=Te.getFromWindowOrThrow=Te.getFromWindow=void 0;function Ut(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Te.getFromWindow=Ut;function Gt(t){const e=Ut(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Te.getFromWindowOrThrow=Gt;function Tl(){return Gt("document")}Te.getDocumentOrThrow=Tl;function xl(){return Ut("document")}var js=Te.getDocument=xl;function Il(){return Gt("navigator")}Te.getNavigatorOrThrow=Il;function Rl(){return Ut("navigator")}var Pn=Te.getNavigator=Rl;function Cl(){return Gt("location")}Te.getLocationOrThrow=Cl;function Al(){return Ut("location")}var $s=Te.getLocation=Al;function Pl(){return Gt("crypto")}Te.getCryptoOrThrow=Pl;function Ll(){return Ut("crypto")}Te.getCrypto=Ll;function Nl(){return Gt("localStorage")}Te.getLocalStorageOrThrow=Nl;function Ul(){return Ut("localStorage")}Te.getLocalStorage=Ul;var Ln={};Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.getWindowMetadata=void 0;const Fs=Te;function Ml(){let t,e;try{t=Fs.getDocumentOrThrow(),e=Fs.getLocationOrThrow()}catch{return null}function r(){const O=t.getElementsByTagName("link"),p=[];for(let E=0;E<O.length;E++){const C=O[E],A=C.getAttribute("rel");if(A&&A.toLowerCase().indexOf("icon")>-1){const U=C.getAttribute("href");if(U)if(U.toLowerCase().indexOf("https:")===-1&&U.toLowerCase().indexOf("http:")===-1&&U.indexOf("//")!==0){let W=e.protocol+"//"+e.host;if(U.indexOf("/")===0)W+=U;else{const S=e.pathname.split("/");S.pop();const R=S.join("/");W+=R+"/"+U}p.push(W)}else if(U.indexOf("//")===0){const W=e.protocol+U;p.push(W)}else p.push(U)}}return p}function n(...O){const p=t.getElementsByTagName("meta");for(let E=0;E<p.length;E++){const C=p[E],A=["itemprop","property","name"].map(U=>C.getAttribute(U)).filter(U=>U?O.includes(U):!1);if(A.length&&A){const U=C.getAttribute("content");if(U)return U}}return""}function i(){let O=n("name","og:site_name","og:title","twitter:title");return O||(O=t.title),O}function s(){return n("description","og:description","twitter:description","keywords")}const c=i(),u=s(),h=e.origin,f=r();return{description:u,url:h,icons:f,name:c}}Ln.getWindowMetadata=Ml;var fr={},jl=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Bs="%[a-f0-9]{2}",zs=new RegExp("("+Bs+")|([^%]+?)","gi"),Hs=new RegExp("("+Bs+")+","gi");function Nn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],Nn(r),Nn(n))}function $l(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(zs)||[],r=1;r<e.length;r++)t=Nn(e,r).join(""),e=t.match(zs)||[];return t}}function Fl(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Hs.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var n=$l(r[0]);n!==r[0]&&(e[r[0]]=n)}r=Hs.exec(t)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),s=0;s<i.length;s++){var c=i[s];t=t.replace(new RegExp(c,"g"),e[c])}return t}var Bl=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Fl(t)}},zl=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},Hl=function(t,e){for(var r={},n=Object.keys(t),i=Array.isArray(e),s=0;s<n.length;s++){var c=n[s],u=t[c];(i?e.indexOf(c)!==-1:e(c,u,t))&&(r[c]=u)}return r};(function(t){const e=jl,r=Bl,n=zl,i=Hl,s=S=>S==null,c=Symbol("encodeFragmentIdentifier");function u(S){switch(S.arrayFormat){case"index":return R=>(b,v)=>{const d=b.length;return v===void 0||S.skipNull&&v===null||S.skipEmptyString&&v===""?b:v===null?[...b,[_(R,S),"[",d,"]"].join("")]:[...b,[_(R,S),"[",_(d,S),"]=",_(v,S)].join("")]};case"bracket":return R=>(b,v)=>v===void 0||S.skipNull&&v===null||S.skipEmptyString&&v===""?b:v===null?[...b,[_(R,S),"[]"].join("")]:[...b,[_(R,S),"[]=",_(v,S)].join("")];case"colon-list-separator":return R=>(b,v)=>v===void 0||S.skipNull&&v===null||S.skipEmptyString&&v===""?b:v===null?[...b,[_(R,S),":list="].join("")]:[...b,[_(R,S),":list=",_(v,S)].join("")];case"comma":case"separator":case"bracket-separator":{const R=S.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(v,d)=>d===void 0||S.skipNull&&d===null||S.skipEmptyString&&d===""?v:(d=d===null?"":d,v.length===0?[[_(b,S),R,_(d,S)].join("")]:[[v,_(d,S)].join(S.arrayFormatSeparator)])}default:return R=>(b,v)=>v===void 0||S.skipNull&&v===null||S.skipEmptyString&&v===""?b:v===null?[...b,_(R,S)]:[...b,[_(R,S),"=",_(v,S)].join("")]}}function h(S){let R;switch(S.arrayFormat){case"index":return(b,v,d)=>{if(R=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!R){d[b]=v;return}d[b]===void 0&&(d[b]={}),d[b][R[1]]=v};case"bracket":return(b,v,d)=>{if(R=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!R){d[b]=v;return}if(d[b]===void 0){d[b]=[v];return}d[b]=[].concat(d[b],v)};case"colon-list-separator":return(b,v,d)=>{if(R=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!R){d[b]=v;return}if(d[b]===void 0){d[b]=[v];return}d[b]=[].concat(d[b],v)};case"comma":case"separator":return(b,v,d)=>{const o=typeof v=="string"&&v.includes(S.arrayFormatSeparator),l=typeof v=="string"&&!o&&O(v,S).includes(S.arrayFormatSeparator);v=l?O(v,S):v;const L=o||l?v.split(S.arrayFormatSeparator).map(P=>O(P,S)):v===null?v:O(v,S);d[b]=L};case"bracket-separator":return(b,v,d)=>{const o=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!o){d[b]=v&&O(v,S);return}const l=v===null?[]:v.split(S.arrayFormatSeparator).map(L=>O(L,S));if(d[b]===void 0){d[b]=l;return}d[b]=[].concat(d[b],l)};default:return(b,v,d)=>{if(d[b]===void 0){d[b]=v;return}d[b]=[].concat(d[b],v)}}}function f(S){if(typeof S!="string"||S.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function _(S,R){return R.encode?R.strict?e(S):encodeURIComponent(S):S}function O(S,R){return R.decode?r(S):S}function p(S){return Array.isArray(S)?S.sort():typeof S=="object"?p(Object.keys(S)).sort((R,b)=>Number(R)-Number(b)).map(R=>S[R]):S}function E(S){const R=S.indexOf("#");return R!==-1&&(S=S.slice(0,R)),S}function C(S){let R="";const b=S.indexOf("#");return b!==-1&&(R=S.slice(b)),R}function A(S){S=E(S);const R=S.indexOf("?");return R===-1?"":S.slice(R+1)}function U(S,R){return R.parseNumbers&&!Number.isNaN(Number(S))&&typeof S=="string"&&S.trim()!==""?S=Number(S):R.parseBooleans&&S!==null&&(S.toLowerCase()==="true"||S.toLowerCase()==="false")&&(S=S.toLowerCase()==="true"),S}function W(S,R){R=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},R),f(R.arrayFormatSeparator);const b=h(R),v=Object.create(null);if(typeof S!="string"||(S=S.trim().replace(/^[?#&]/,""),!S))return v;for(const d of S.split("&")){if(d==="")continue;let[o,l]=n(R.decode?d.replace(/\+/g," "):d,"=");l=l===void 0?null:["comma","separator","bracket-separator"].includes(R.arrayFormat)?l:O(l,R),b(O(o,R),l,v)}for(const d of Object.keys(v)){const o=v[d];if(typeof o=="object"&&o!==null)for(const l of Object.keys(o))o[l]=U(o[l],R);else v[d]=U(o,R)}return R.sort===!1?v:(R.sort===!0?Object.keys(v).sort():Object.keys(v).sort(R.sort)).reduce((d,o)=>{const l=v[o];return l&&typeof l=="object"&&!Array.isArray(l)?d[o]=p(l):d[o]=l,d},Object.create(null))}t.extract=A,t.parse=W,t.stringify=(S,R)=>{if(!S)return"";R=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},R),f(R.arrayFormatSeparator);const b=l=>R.skipNull&&s(S[l])||R.skipEmptyString&&S[l]==="",v=u(R),d={};for(const l of Object.keys(S))b(l)||(d[l]=S[l]);const o=Object.keys(d);return R.sort!==!1&&o.sort(R.sort),o.map(l=>{const L=S[l];return L===void 0?"":L===null?_(l,R):Array.isArray(L)?L.length===0&&R.arrayFormat==="bracket-separator"?_(l,R)+"[]":L.reduce(v(l),[]).join("&"):_(l,R)+"="+_(L,R)}).filter(l=>l.length>0).join("&")},t.parseUrl=(S,R)=>{R=Object.assign({decode:!0},R);const[b,v]=n(S,"#");return Object.assign({url:b.split("?")[0]||"",query:W(A(S),R)},R&&R.parseFragmentIdentifier&&v?{fragmentIdentifier:O(v,R)}:{})},t.stringifyUrl=(S,R)=>{R=Object.assign({encode:!0,strict:!0,[c]:!0},R);const b=E(S.url).split("?")[0]||"",v=t.extract(S.url),d=t.parse(v,{sort:!1}),o=Object.assign(d,S.query);let l=t.stringify(o,R);l&&(l=`?${l}`);let L=C(S.url);return S.fragmentIdentifier&&(L=`#${R[c]?_(S.fragmentIdentifier,R):S.fragmentIdentifier}`),`${b}${l}${L}`},t.pick=(S,R,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[c]:!1},b);const{url:v,query:d,fragmentIdentifier:o}=t.parseUrl(S,b);return t.stringifyUrl({url:v,query:i(d,R),fragmentIdentifier:o},b)},t.exclude=(S,R,b)=>{const v=Array.isArray(R)?d=>!R.includes(d):(d,o)=>!R(d,o);return t.pick(S,v,b)}})(fr);const Kl={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Ks="base10",st="base16",Un="base64pad",Mn="utf8",Gs=0,Vt=1,Gl=0,Vs=1,jn=12,$n=32;function Vl(){const t=An.generateKeyPair();return{privateKey:nt(t.secretKey,st),publicKey:nt(t.publicKey,st)}}function Fn(){const t=Kt.randomBytes($n);return nt(t,st)}function ql(t,e){const r=An.sharedKey(it(t,st),it(e,st)),n=new ll(Lr.SHA256,r).expand($n);return nt(n,st)}function Wl(t){const e=Lr.hash(it(t,st));return nt(e,st)}function Bn(t){const e=Lr.hash(it(t,Mn));return nt(e,st)}function Yl(t){return it(`${t}`,Ks)}function hr(t){return Number(nt(t,Ks))}function Xl(t){const e=Yl(typeof t.type<"u"?t.type:Gs);if(hr(e)===Vt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?it(t.senderPublicKey,st):void 0,n=typeof t.iv<"u"?it(t.iv,st):Kt.randomBytes(jn),i=new In.ChaCha20Poly1305(it(t.symKey,st)).seal(n,it(t.message,Mn));return Jl({type:e,sealed:i,iv:n,senderPublicKey:r})}function kl(t){const e=new In.ChaCha20Poly1305(it(t.symKey,st)),{sealed:r,iv:n}=Nr(t.encoded),i=e.open(n,r);if(i===null)throw new Error("Failed to decrypt");return nt(i,Mn)}function Jl(t){if(hr(t.type)===Vt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return nt(Sn([t.type,t.senderPublicKey,t.iv,t.sealed]),Un)}return nt(Sn([t.type,t.iv,t.sealed]),Un)}function Nr(t){const e=it(t,Un),r=e.slice(Gl,Vs),n=Vs;if(hr(r)===Vt){const u=n+$n,h=u+jn,f=e.slice(n,u),_=e.slice(u,h),O=e.slice(h);return{type:r,sealed:O,iv:_,senderPublicKey:f}}const i=n+jn,s=e.slice(n,i),c=e.slice(i);return{type:r,sealed:c,iv:s}}function Zl(t,e){const r=Nr(t);return qs({type:hr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?nt(r.senderPublicKey,st):void 0,receiverPublicKey:e?.receiverPublicKey})}function qs(t){const e=t?.type||Gs;if(e===Vt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Ws(t){return t.type===Vt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Ql=Object.defineProperty,Ys=Object.getOwnPropertySymbols,ed=Object.prototype.hasOwnProperty,td=Object.prototype.propertyIsEnumerable,Xs=(t,e,r)=>e in t?Ql(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ks=(t,e)=>{for(var r in e||(e={}))ed.call(e,r)&&Xs(t,r,e[r]);if(Ys)for(var r of Ys(e))td.call(e,r)&&Xs(t,r,e[r]);return t};const rd="ReactNative",lr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},nd="js";function zn(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Js(){return!js()&&!!Pn()&&navigator.product===rd}function Zs(){return!zn()&&!!Pn()}function id(){return Js()?lr.reactNative:zn()?lr.node:Zs()?lr.browser:lr.unknown}function sd(t,e){let r=fr.parse(t);return r=ks(ks({},r),e),t=fr.stringify(r),t}function od(){if(typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const t=wl();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function ad(){var t;const e=id();return e===lr.browser?[e,((t=$s())==null?void 0:t.host)||"unknown"].join(":"):e}function cd(t,e,r){const n=od(),i=ad();return[[t,e].join("-"),[nd,r].join("-"),n,i].join("/")}function ud({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:c}){const u=r.split("?"),h=cd(t,e,n),f={auth:i,ua:h,projectId:s,useOnCloseEvent:c||void 0},_=sd(u[1]||"",f);return u[0]+"?"+_}function Qs(t){return Object.fromEntries(t.entries())}function eo(t){return new Map(Object.entries(t))}function fd(t=ce.FIVE_MINUTES,e){const r=ce.toMiliseconds(t||ce.FIVE_MINUTES);let n,i,s;return{resolve:c=>{s&&n&&(clearTimeout(s),n(c))},reject:c=>{s&&i&&(clearTimeout(s),i(c))},done:()=>new Promise((c,u)=>{s=setTimeout(()=>{u(new Error(e))},r),n=c,i=u})}}function Ur(t,e,r){return new Promise(async(n,i)=>{const s=setTimeout(()=>i(new Error(r)),e);try{const c=await t;n(c)}catch(c){i(c)}clearTimeout(s)})}function to(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function hd(t){return to("topic",t)}function ld(t){return to("id",t)}function dd(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function Hn(t,e){return ce.fromMiliseconds((e||Date.now())+ce.toMiliseconds(t))}function ro(t){return Date.now()>=ce.toMiliseconds(t)}function Kn(t,e){return`${t}${e?`:${e}`:""}`}const gd="irn";function Gn(t){return t?.relay||{protocol:gd}}function Mr(t){const e=Kl[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var _d=Object.defineProperty,no=Object.getOwnPropertySymbols,yd=Object.prototype.hasOwnProperty,pd=Object.prototype.propertyIsEnumerable,io=(t,e,r)=>e in t?_d(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bd=(t,e)=>{for(var r in e||(e={}))yd.call(e,r)&&io(t,r,e[r]);if(no)for(var r of no(e))pd.call(e,r)&&io(t,r,e[r]);return t};function vd(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),c=t[i];r[s]=c}}),r}function Ed(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",c=fr.parse(s);return{protocol:n,topic:wd(i[0]),version:parseInt(i[1],10),symKey:c.symKey,relay:vd(c)}}function wd(t){return t.startsWith("//")?t.substring(2):t}function md(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=r+e+i;t[i]&&(n[s]=t[i])}),n}function Dd(t){return`${t.protocol}:${t.topic}@${t.version}?`+fr.stringify(bd({symKey:t.symKey},md(t.relay)))}const Sd={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Od={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function xe(t,e){const{message:r,code:n}=Od[t];return{message:e?`${r} ${e}`:r,code:n}}function dr(t,e){const{message:r,code:n}=Sd[t];return{message:e?`${r} ${e}`:r,code:n}}function Td(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function jr(t){return typeof t>"u"}function so(t,e){return e&&jr(t)?!0:typeof t=="string"&&!!t.trim().length}function xd(t){if(so(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Id(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Rd(t){return t?.topic}function Vn(t){return typeof t<"u"&&typeof t!==null}const qn="wc",oo=2,$r="core",vt=`${qn}@2:${$r}:`,ao={name:$r,logger:"error"},co={database:":memory:"},uo="crypto",Wn="client_ed25519_seed",fo=ce.ONE_DAY,ho="keychain",lo="0.3",go="messages",_o="0.3",yo=ce.SIX_HOURS,po="publisher",bo="irn",vo="error",Yn="wss://relay.walletconnect.com",Eo="relayer",ze={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},wo="_subscription",qt={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},mo=ce.ONE_SECOND/2,Cd={database:":memory:"},Do="2.8.4",So=1e4,Oo="0.3",To="WALLETCONNECT_CLIENT_ID",dt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Ad=ce.THIRTY_DAYS,xo="subscription",Io="0.3",Ro=ce.FIVE_SECONDS*1e3,Co="pairing",Ao="0.3",Pd=ce.THIRTY_DAYS,Wt={wc_pairingDelete:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:0},res:{ttl:ce.ONE_DAY,prompt:!1,tag:0}}},gt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Po="history",Lo="0.3",No="expirer",ft={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Uo="0.3",Ld=ce.ONE_DAY,Fr="verify-api",Xn="https://verify.walletconnect.com";class Mo{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=ho,this.version=lo,this.initialized=!1,this.storagePrefix=vt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=xe("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Qs(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?eo(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class jo{constructor(e,r,n){this.core=e,this.logger=r,this.name=uo,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=Os(i);return Ss(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=Vl();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),c=Os(s),u=Fn();return await Qh(u,i,fo,c)},this.generateSharedKey=(i,s,c)=>{this.isInitialized();const u=this.getPrivateKey(i),h=ql(u,s);return this.setSymKey(h,c)},this.setSymKey=async(i,s)=>{this.isInitialized();const c=s||Wl(i);return await this.keychain.set(c,i),c},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,c)=>{this.isInitialized();const u=qs(c),h=pn(s);if(Ws(u)){const p=u.senderPublicKey,E=u.receiverPublicKey;i=await this.generateSharedKey(p,E)}const f=this.getSymKey(i),{type:_,senderPublicKey:O}=u;return Xl({type:_,symKey:f,message:h,senderPublicKey:O})},this.decode=async(i,s,c)=>{this.isInitialized();const u=Zl(s,c);if(Ws(u)){const _=u.receiverPublicKey,O=u.senderPublicKey;i=await this.generateSharedKey(_,O)}const h=this.getSymKey(i),f=kl({symKey:h,encoded:s});return Yi(f)},this.getPayloadType=i=>{const s=Nr(i);return hr(s.type)},this.getPayloadSenderPublicKey=i=>{const s=Nr(i);return s.senderPublicKey?nt(s.senderPublicKey,st):void 0},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.keychain=n||new Mo(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Wn)}catch{e=Fn(),await this.keychain.set(Wn,e)}return it(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class $o extends Nu{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=go,this.version=_o,this.initialized=!1,this.storagePrefix=vt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=Bn(i);let c=this.messages.get(n);return typeof c>"u"&&(c={}),typeof c[s]<"u"||(c[s]=i,this.messages.set(n,c),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),c=Bn(i);return typeof s[c]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=r}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Qs(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?eo(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}const Nd="PARSE_ERROR",Ud="INVALID_REQUEST",Md="METHOD_NOT_FOUND",jd="INVALID_PARAMS",Fo="INTERNAL_ERROR",kn="SERVER_ERROR",$d=[-32700,-32600,-32601,-32602,-32603],gr={[Nd]:{code:-32700,message:"Parse error"},[Ud]:{code:-32600,message:"Invalid Request"},[Md]:{code:-32601,message:"Method not found"},[jd]:{code:-32602,message:"Invalid params"},[Fo]:{code:-32603,message:"Internal error"},[kn]:{code:-32e3,message:"Server error"}},Bo=kn;function Fd(t){return $d.includes(t)}function zo(t){return Object.keys(gr).includes(t)?gr[t]:gr[Bo]}function Bd(t){const e=Object.values(gr).find(r=>r.code===t);return e||gr[Bo]}function zd(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Ho={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Jn=function(t,e){return Jn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Jn(t,e)};function Hd(t,e){Jn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Zn=function(){return Zn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Zn.apply(this,arguments)};function Kd(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Gd(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(c=t[u])&&(s=(i<3?c(s):i>3?c(e,r,s):c(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Vd(t,e){return function(r,n){e(r,n,t)}}function qd(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Wd(t,e,r,n){function i(s){return s instanceof r?s:new r(function(c){c(s)})}return new(r||(r=Promise))(function(s,c){function u(_){try{f(n.next(_))}catch(O){c(O)}}function h(_){try{f(n.throw(_))}catch(O){c(O)}}function f(_){_.done?s(_.value):i(_.value).then(u,h)}f((n=n.apply(t,e||[])).next())})}function Yd(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,c;return c={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(f){return function(_){return h([f,_])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(_){f=[6,_],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Xd(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function kd(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Qn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ko(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],c;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){c={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(c)throw c.error}}return s}function Jd(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ko(arguments[e]));return t}function Zd(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],c=0,u=s.length;c<u;c++,i++)n[i]=s[c];return n}function _r(t){return this instanceof _r?(this.v=t,this):new _r(t)}function Qd(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return"),i[Symbol.asyncIterator]=function(){return this},i;function c(p){n[p]&&(i[p]=function(E){return new Promise(function(C,A){s.push([p,E,C,A])>1||u(p,E)})})}function u(p,E){try{h(n[p](E))}catch(C){O(s[0][3],C)}}function h(p){p.value instanceof _r?Promise.resolve(p.value.v).then(f,_):O(s[0][2],p)}function f(p){u("next",p)}function _(p){u("throw",p)}function O(p,E){p(E),s.shift(),s.length&&u(s[0][0],s[0][1])}}function e0(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(c){return(r=!r)?{value:_r(t[i](c)),done:i==="return"}:s?s(c):c}:s}}function t0(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Qn=="function"?Qn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(c){return new Promise(function(u,h){c=t[s](c),i(u,h,c.done,c.value)})}}function i(s,c,u,h){Promise.resolve(h).then(function(f){s({value:f,done:u})},c)}}function r0(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function n0(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function i0(t){return t&&t.__esModule?t:{default:t}}function s0(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function o0(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var a0=Object.freeze({__proto__:null,__extends:Hd,get __assign(){return Zn},__rest:Kd,__decorate:Gd,__param:Vd,__metadata:qd,__awaiter:Wd,__generator:Yd,__createBinding:Xd,__exportStar:kd,__values:Qn,__read:Ko,__spread:Jd,__spreadArrays:Zd,__await:_r,__asyncGenerator:Qd,__asyncDelegator:e0,__asyncValues:t0,__makeTemplateObject:r0,__importStar:n0,__importDefault:i0,__classPrivateFieldGet:s0,__classPrivateFieldSet:o0}),c0=Rt(a0),Et={},Go;function u0(){if(Go)return Et;Go=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.isBrowserCryptoAvailable=Et.getSubtleCrypto=Et.getBrowerCrypto=void 0;function t(){return Je?.crypto||Je?.msCrypto||{}}Et.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}Et.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Et.isBrowserCryptoAvailable=r,Et}var wt={},Vo;function f0(){if(Vo)return wt;Vo=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.isBrowser=wt.isNode=wt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}wt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}wt.isNode=e;function r(){return!t()&&!e()}return wt.isBrowser=r,wt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=c0;e.__exportStar(u0(),t),e.__exportStar(f0(),t)})(Ho);function qo(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Wo(t=6){return BigInt(qo(t))}function ei(t,e,r){return{id:r||qo(),jsonrpc:"2.0",method:t,params:e}}function Yo(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Xo(t,e,r){return{id:t,jsonrpc:"2.0",error:h0(e,r)}}function h0(t,e){return typeof t>"u"?zo(Fo):(typeof t=="string"&&(t=Object.assign(Object.assign({},zo(kn)),{message:t})),typeof e<"u"&&(t.data=e),Fd(t.code)&&(t=Bd(t.code)),t)}class l0{}class d0 extends l0{constructor(){super()}}class g0 extends d0{constructor(e){super()}}const _0="^wss?:";function y0(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function p0(t,e){const r=y0(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function ko(t){return p0(t,_0)}function b0(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Jo(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Zo(t){return Jo(t)&&"method"in t}function ti(t){return Jo(t)&&(Qo(t)||Br(t))}function Qo(t){return"result"in t}function Br(t){return"error"in t}class v0 extends g0{constructor(e){super(e),this.events=new ut.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(ei(e.method,e.params||[],e.id||Wo().toString()),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{Br(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ti(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const ea=10,E0=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),w0=()=>typeof window<"u",m0=E0();class D0{constructor(e){if(this.url=e,this.events=new ut.exports.EventEmitter,this.registering=!1,!ko(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(pn(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!ko(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=Ho.isReactNative()?void 0:{rejectUnauthorized:!b0(e)},s=new m0(e,[],i);w0()?s.onerror=c=>{const u=c;n(this.emitError(u.error))}:s.on("error",c=>{n(this.emitError(c))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Yi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=Xo(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return zd(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ea&&this.events.setMaxListeners(ea)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}class S0 extends Uu{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ut.exports.EventEmitter,this.name=po,this.queue=new Map,this.publishTimeout=ce.toMiliseconds(ce.TEN_SECONDS),this.queueTimeout=ce.toMiliseconds(ce.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const c=s?.ttl||yo,u=Gn(s),h=s?.prompt||!1,f=s?.tag||0,_=s?.id||Wo().toString(),O={topic:n,message:i,opts:{ttl:c,relay:u,prompt:h,tag:f,id:_}},p=setTimeout(()=>this.queue.set(_,O),this.queueTimeout);try{await await Ur(this.rpcPublish(n,i,c,u,h,f,_),this.publishTimeout),clearTimeout(p),this.relayer.events.emit(ze.publish,O)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(c){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(c),c}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,r,n,i,s,c,u){var h,f,_,O;const p={method:Mr(i.protocol).publish,params:{topic:e,message:r,ttl:n,prompt:s,tag:c},id:u};return jr((h=p.params)==null?void 0:h.prompt)&&((f=p.params)==null||delete f.prompt),jr((_=p.params)==null?void 0:_.tag)&&((O=p.params)==null||delete O.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p}),this.relayer.request(p)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:n,opts:i}=e;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(er.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(ze.connection_stalled);return}this.checkQueue()}),this.relayer.on(ze.message_ack,e=>{this.onPublish(e.id.toString())})}}class O0{constructor(){this.map=new Map,this.set=(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var T0=Object.defineProperty,x0=Object.defineProperties,I0=Object.getOwnPropertyDescriptors,ta=Object.getOwnPropertySymbols,R0=Object.prototype.hasOwnProperty,C0=Object.prototype.propertyIsEnumerable,ra=(t,e,r)=>e in t?T0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,yr=(t,e)=>{for(var r in e||(e={}))R0.call(e,r)&&ra(t,r,e[r]);if(ta)for(var r of ta(e))C0.call(e,r)&&ra(t,r,e[r]);return t},ri=(t,e)=>x0(t,I0(e));class na extends $u{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new O0,this.events=new ut.exports.EventEmitter,this.name=xo,this.version=Io,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=vt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=Gn(i),c={topic:n,relay:s};this.pending.set(n,c);const u=await this.rpcSubscribe(n,s);return this.onSubscribe(u,c),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),u}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const c=new ce.Watch;c.start(this.pendingSubscriptionWatchLabel);const u=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(u),c.stop(this.pendingSubscriptionWatchLabel),i(!0)),c.elapsed(this.pendingSubscriptionWatchLabel)>=Ro&&(clearInterval(u),c.stop(this.pendingSubscriptionWatchLabel),s(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.clientId=""}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=Gn(n);await this.rpcUnsubscribe(e,r,i);const s=dr("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r){const n={method:Mr(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Ur(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(ze.connection_stalled)}return Bn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:Mr(r.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Ur(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(ze.connection_stalled)}}rpcUnsubscribe(e,r,n){const i={method:Mr(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,r){this.setSubscription(e,ri(yr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,yr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,yr({},r)),this.topicMap.set(r.topic,e),this.events.emit(dt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(dt.deleted,ri(yr({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(dt.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(dt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);Td(r)&&this.onBatchSubscribe(r.map((n,i)=>ri(yr({},e[i]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(er.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(ze.connect,async()=>{await this.onConnect()}),this.relayer.on(ze.disconnect,()=>{this.onDisconnect()}),this.events.on(dt.created,async e=>{const r=dt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(dt.deleted,async e=>{const r=dt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var A0=Object.defineProperty,ia=Object.getOwnPropertySymbols,P0=Object.prototype.hasOwnProperty,L0=Object.prototype.propertyIsEnumerable,sa=(t,e,r)=>e in t?A0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,N0=(t,e)=>{for(var r in e||(e={}))P0.call(e,r)&&sa(t,r,e[r]);if(ia)for(var r of ia(e))L0.call(e,r)&&sa(t,r,e[r]);return t};class oa extends Mu{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ut.exports.EventEmitter,this.name=Eo,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):Se.pino(Se.getDefaultLoggerOptions({level:e.logger||vo})),this.messages=new $o(this.logger,e.core),this.subscriber=new na(this,this.logger),this.publisher=new S0(this,this.logger),this.relayUrl=e?.relayUrl||Yn,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribted to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},So)}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var n;this.isInitialized();let i=((n=this.subscriber.topicMap.get(e))==null?void 0:n[0])||"";return i||(await Promise.all([new Promise(s=>{this.subscriber.once(dt.created,c=>{c.topic===e&&s()})}),new Promise(async s=>{i=await this.subscriber.subscribe(e,r),s()})]),i)}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(ze.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(dt.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,n)=>{await Ur(this.provider.connect(),5e3,"socket stalled").catch(i=>n(i)).then(()=>r()).finally(()=>this.removeListener(ze.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(ze.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.events.emit(ze.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(qt.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new v0(new D0(ud({sdkVersion:Do,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:n}=e;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Zo(e)){if(!e.method.endsWith(wo))return;const r=e.params,{topic:n,message:i,publishedAt:s}=r.data,c={topic:n,message:i,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(N0({type:"event",event:r.id},c)),this.events.emit(r.id,c),await this.acknowledgePayload(e),await this.onMessageEvent(c)}else ti(e)&&this.events.emit(ze.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(ze.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Yo(e.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(qt.payload,e=>this.onProviderPayload(e)),this.provider.on(qt.connect,()=>{this.events.emit(ze.connect)}),this.provider.on(qt.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(qt.error,e=>{this.logger.error(e),this.events.emit(ze.error,e)})}registerEventListeners(){this.events.on(ze.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(ze.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ce.toMiliseconds(mo))}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var ni={exports:{}};(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,s=2,c=9007199254740991,u="[object Arguments]",h="[object Array]",f="[object AsyncFunction]",_="[object Boolean]",O="[object Date]",p="[object Error]",E="[object Function]",C="[object GeneratorFunction]",A="[object Map]",U="[object Number]",W="[object Null]",S="[object Object]",R="[object Promise]",b="[object Proxy]",v="[object RegExp]",d="[object Set]",o="[object String]",l="[object Symbol]",L="[object Undefined]",P="[object WeakMap]",H="[object ArrayBuffer]",G="[object DataView]",J="[object Float32Array]",D="[object Float64Array]",I="[object Int8Array]",V="[object Int16Array]",F="[object Int32Array]",M="[object Uint8Array]",$="[object Uint8ClampedArray]",N="[object Uint16Array]",B="[object Uint32Array]",ee=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,Y={};Y[J]=Y[D]=Y[I]=Y[V]=Y[F]=Y[M]=Y[$]=Y[N]=Y[B]=!0,Y[u]=Y[h]=Y[H]=Y[_]=Y[G]=Y[O]=Y[p]=Y[E]=Y[A]=Y[U]=Y[S]=Y[v]=Y[d]=Y[o]=Y[P]=!1;var Q=typeof Je=="object"&&Je&&Je.Object===Object&&Je,x=typeof self=="object"&&self&&self.Object===Object&&self,T=Q||x||Function("return this")(),w=e&&!e.nodeType&&e,a=w&&!0&&t&&!t.nodeType&&t,y=a&&a.exports===w,K=y&&Q.process,q=function(){try{return K&&K.binding&&K.binding("util")}catch{}}(),he=q&&q.isTypedArray;function pe(g,m){for(var j=-1,X=g==null?0:g.length,Ie=0,ie=[];++j<X;){var Ne=g[j];m(Ne,j,g)&&(ie[Ie++]=Ne)}return ie}function de(g,m){for(var j=-1,X=m.length,Ie=g.length;++j<X;)g[Ie+j]=m[j];return g}function Ee(g,m){for(var j=-1,X=g==null?0:g.length;++j<X;)if(m(g[j],j,g))return!0;return!1}function Ue(g,m){for(var j=-1,X=Array(g);++j<g;)X[j]=m(j);return X}function Ae(g){return function(m){return g(m)}}function ye(g,m){return g.has(m)}function ge(g,m){return g?.[m]}function le(g){var m=-1,j=Array(g.size);return g.forEach(function(X,Ie){j[++m]=[Ie,X]}),j}function ue(g,m){return function(j){return g(m(j))}}function ae(g){var m=-1,j=Array(g.size);return g.forEach(function(X){j[++m]=X}),j}var oe=Array.prototype,se=Function.prototype,te=Object.prototype,fe=T["__core-js_shared__"],_e=se.toString,ne=te.hasOwnProperty,be=function(){var g=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),ve=te.toString,me=RegExp("^"+_e.call(ne).replace(ee,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=y?T.Buffer:void 0,we=T.Symbol,_t=T.Uint8Array,bt=te.propertyIsEnumerable,Ot=oe.splice,at=we?we.toStringTag:void 0,Mt=Object.getOwnPropertySymbols,pr=De?De.isBuffer:void 0,Hr=ue(Object.keys,Object),Me=Yt(T,"DataView"),Pe=Yt(T,"Map"),je=Yt(T,"Promise"),$e=Yt(T,"Set"),Fe=Yt(T,"WeakMap"),Le=Yt(Object,"create"),Ke=$t(Me),Ge=$t(Pe),Ve=$t(je),qe=$t($e),We=$t(Fe),He=we?we.prototype:void 0,Be=He?He.valueOf:void 0;function Re(g){var m=-1,j=g==null?0:g.length;for(this.clear();++m<j;){var X=g[m];this.set(X[0],X[1])}}function Ye(){this.__data__=Le?Le(null):{},this.size=0}function Xe(g){var m=this.has(g)&&delete this.__data__[g];return this.size-=m?1:0,m}function K0(g){var m=this.__data__;if(Le){var j=m[g];return j===n?void 0:j}return ne.call(m,g)?m[g]:void 0}function G0(g){var m=this.__data__;return Le?m[g]!==void 0:ne.call(m,g)}function V0(g,m){var j=this.__data__;return this.size+=this.has(g)?0:1,j[g]=Le&&m===void 0?n:m,this}Re.prototype.clear=Ye,Re.prototype.delete=Xe,Re.prototype.get=K0,Re.prototype.has=G0,Re.prototype.set=V0;function mt(g){var m=-1,j=g==null?0:g.length;for(this.clear();++m<j;){var X=g[m];this.set(X[0],X[1])}}function q0(){this.__data__=[],this.size=0}function W0(g){var m=this.__data__,j=Gr(m,g);if(j<0)return!1;var X=m.length-1;return j==X?m.pop():Ot.call(m,j,1),--this.size,!0}function Y0(g){var m=this.__data__,j=Gr(m,g);return j<0?void 0:m[j][1]}function X0(g){return Gr(this.__data__,g)>-1}function k0(g,m){var j=this.__data__,X=Gr(j,g);return X<0?(++this.size,j.push([g,m])):j[X][1]=m,this}mt.prototype.clear=q0,mt.prototype.delete=W0,mt.prototype.get=Y0,mt.prototype.has=X0,mt.prototype.set=k0;function jt(g){var m=-1,j=g==null?0:g.length;for(this.clear();++m<j;){var X=g[m];this.set(X[0],X[1])}}function J0(){this.size=0,this.__data__={hash:new Re,map:new(Pe||mt),string:new Re}}function Z0(g){var m=Vr(this,g).delete(g);return this.size-=m?1:0,m}function Q0(g){return Vr(this,g).get(g)}function eg(g){return Vr(this,g).has(g)}function tg(g,m){var j=Vr(this,g),X=j.size;return j.set(g,m),this.size+=j.size==X?0:1,this}jt.prototype.clear=J0,jt.prototype.delete=Z0,jt.prototype.get=Q0,jt.prototype.has=eg,jt.prototype.set=tg;function Kr(g){var m=-1,j=g==null?0:g.length;for(this.__data__=new jt;++m<j;)this.add(g[m])}function rg(g){return this.__data__.set(g,n),this}function ng(g){return this.__data__.has(g)}Kr.prototype.add=Kr.prototype.push=rg,Kr.prototype.has=ng;function Tt(g){var m=this.__data__=new mt(g);this.size=m.size}function ig(){this.__data__=new mt,this.size=0}function sg(g){var m=this.__data__,j=m.delete(g);return this.size=m.size,j}function og(g){return this.__data__.get(g)}function ag(g){return this.__data__.has(g)}function cg(g,m){var j=this.__data__;if(j instanceof mt){var X=j.__data__;if(!Pe||X.length<r-1)return X.push([g,m]),this.size=++j.size,this;j=this.__data__=new jt(X)}return j.set(g,m),this.size=j.size,this}Tt.prototype.clear=ig,Tt.prototype.delete=sg,Tt.prototype.get=og,Tt.prototype.has=ag,Tt.prototype.set=cg;function ug(g,m){var j=qr(g),X=!j&&Sg(g),Ie=!j&&!X&&ii(g),ie=!j&&!X&&!Ie&&Ta(g),Ne=j||X||Ie||ie,ke=Ne?Ue(g.length,String):[],Qe=ke.length;for(var Ce in g)(m||ne.call(g,Ce))&&!(Ne&&(Ce=="length"||Ie&&(Ce=="offset"||Ce=="parent")||ie&&(Ce=="buffer"||Ce=="byteLength"||Ce=="byteOffset")||vg(Ce,Qe)))&&ke.push(Ce);return ke}function Gr(g,m){for(var j=g.length;j--;)if(ma(g[j][0],m))return j;return-1}function fg(g,m,j){var X=m(g);return qr(g)?X:de(X,j(g))}function br(g){return g==null?g===void 0?L:W:at&&at in Object(g)?pg(g):Dg(g)}function ba(g){return vr(g)&&br(g)==u}function va(g,m,j,X,Ie){return g===m?!0:g==null||m==null||!vr(g)&&!vr(m)?g!==g&&m!==m:hg(g,m,j,X,va,Ie)}function hg(g,m,j,X,Ie,ie){var Ne=qr(g),ke=qr(m),Qe=Ne?h:xt(g),Ce=ke?h:xt(m);Qe=Qe==u?S:Qe,Ce=Ce==u?S:Ce;var ct=Qe==S,yt=Ce==S,tt=Qe==Ce;if(tt&&ii(g)){if(!ii(m))return!1;Ne=!0,ct=!1}if(tt&&!ct)return ie||(ie=new Tt),Ne||Ta(g)?Ea(g,m,j,X,Ie,ie):_g(g,m,Qe,j,X,Ie,ie);if(!(j&i)){var ht=ct&&ne.call(g,"__wrapped__"),lt=yt&&ne.call(m,"__wrapped__");if(ht||lt){var It=ht?g.value():g,Dt=lt?m.value():m;return ie||(ie=new Tt),Ie(It,Dt,j,X,ie)}}return tt?(ie||(ie=new Tt),yg(g,m,j,X,Ie,ie)):!1}function lg(g){if(!Oa(g)||wg(g))return!1;var m=Da(g)?me:z;return m.test($t(g))}function dg(g){return vr(g)&&Sa(g.length)&&!!Y[br(g)]}function gg(g){if(!mg(g))return Hr(g);var m=[];for(var j in Object(g))ne.call(g,j)&&j!="constructor"&&m.push(j);return m}function Ea(g,m,j,X,Ie,ie){var Ne=j&i,ke=g.length,Qe=m.length;if(ke!=Qe&&!(Ne&&Qe>ke))return!1;var Ce=ie.get(g);if(Ce&&ie.get(m))return Ce==m;var ct=-1,yt=!0,tt=j&s?new Kr:void 0;for(ie.set(g,m),ie.set(m,g);++ct<ke;){var ht=g[ct],lt=m[ct];if(X)var It=Ne?X(lt,ht,ct,m,g,ie):X(ht,lt,ct,g,m,ie);if(It!==void 0){if(It)continue;yt=!1;break}if(tt){if(!Ee(m,function(Dt,Ft){if(!ye(tt,Ft)&&(ht===Dt||Ie(ht,Dt,j,X,ie)))return tt.push(Ft)})){yt=!1;break}}else if(!(ht===lt||Ie(ht,lt,j,X,ie))){yt=!1;break}}return ie.delete(g),ie.delete(m),yt}function _g(g,m,j,X,Ie,ie,Ne){switch(j){case G:if(g.byteLength!=m.byteLength||g.byteOffset!=m.byteOffset)return!1;g=g.buffer,m=m.buffer;case H:return!(g.byteLength!=m.byteLength||!ie(new _t(g),new _t(m)));case _:case O:case U:return ma(+g,+m);case p:return g.name==m.name&&g.message==m.message;case v:case o:return g==m+"";case A:var ke=le;case d:var Qe=X&i;if(ke||(ke=ae),g.size!=m.size&&!Qe)return!1;var Ce=Ne.get(g);if(Ce)return Ce==m;X|=s,Ne.set(g,m);var ct=Ea(ke(g),ke(m),X,Ie,ie,Ne);return Ne.delete(g),ct;case l:if(Be)return Be.call(g)==Be.call(m)}return!1}function yg(g,m,j,X,Ie,ie){var Ne=j&i,ke=wa(g),Qe=ke.length,Ce=wa(m),ct=Ce.length;if(Qe!=ct&&!Ne)return!1;for(var yt=Qe;yt--;){var tt=ke[yt];if(!(Ne?tt in m:ne.call(m,tt)))return!1}var ht=ie.get(g);if(ht&&ie.get(m))return ht==m;var lt=!0;ie.set(g,m),ie.set(m,g);for(var It=Ne;++yt<Qe;){tt=ke[yt];var Dt=g[tt],Ft=m[tt];if(X)var xa=Ne?X(Ft,Dt,tt,m,g,ie):X(Dt,Ft,tt,g,m,ie);if(!(xa===void 0?Dt===Ft||Ie(Dt,Ft,j,X,ie):xa)){lt=!1;break}It||(It=tt=="constructor")}if(lt&&!It){var Wr=g.constructor,Yr=m.constructor;Wr!=Yr&&"constructor"in g&&"constructor"in m&&!(typeof Wr=="function"&&Wr instanceof Wr&&typeof Yr=="function"&&Yr instanceof Yr)&&(lt=!1)}return ie.delete(g),ie.delete(m),lt}function wa(g){return fg(g,xg,bg)}function Vr(g,m){var j=g.__data__;return Eg(m)?j[typeof m=="string"?"string":"hash"]:j.map}function Yt(g,m){var j=ge(g,m);return lg(j)?j:void 0}function pg(g){var m=ne.call(g,at),j=g[at];try{g[at]=void 0;var X=!0}catch{}var Ie=ve.call(g);return X&&(m?g[at]=j:delete g[at]),Ie}var bg=Mt?function(g){return g==null?[]:(g=Object(g),pe(Mt(g),function(m){return bt.call(g,m)}))}:Ig,xt=br;(Me&&xt(new Me(new ArrayBuffer(1)))!=G||Pe&&xt(new Pe)!=A||je&&xt(je.resolve())!=R||$e&&xt(new $e)!=d||Fe&&xt(new Fe)!=P)&&(xt=function(g){var m=br(g),j=m==S?g.constructor:void 0,X=j?$t(j):"";if(X)switch(X){case Ke:return G;case Ge:return A;case Ve:return R;case qe:return d;case We:return P}return m});function vg(g,m){return m=m??c,!!m&&(typeof g=="number"||Z.test(g))&&g>-1&&g%1==0&&g<m}function Eg(g){var m=typeof g;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?g!=="__proto__":g===null}function wg(g){return!!be&&be in g}function mg(g){var m=g&&g.constructor,j=typeof m=="function"&&m.prototype||te;return g===j}function Dg(g){return ve.call(g)}function $t(g){if(g!=null){try{return _e.call(g)}catch{}try{return g+""}catch{}}return""}function ma(g,m){return g===m||g!==g&&m!==m}var Sg=ba(function(){return arguments}())?ba:function(g){return vr(g)&&ne.call(g,"callee")&&!bt.call(g,"callee")},qr=Array.isArray;function Og(g){return g!=null&&Sa(g.length)&&!Da(g)}var ii=pr||Rg;function Tg(g,m){return va(g,m)}function Da(g){if(!Oa(g))return!1;var m=br(g);return m==E||m==C||m==f||m==b}function Sa(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=c}function Oa(g){var m=typeof g;return g!=null&&(m=="object"||m=="function")}function vr(g){return g!=null&&typeof g=="object"}var Ta=he?Ae(he):dg;function xg(g){return Og(g)?ug(g):gg(g)}function Ig(){return[]}function Rg(){return!1}t.exports=Tg})(ni,ni.exports);var U0=ni.exports,M0=Object.defineProperty,aa=Object.getOwnPropertySymbols,j0=Object.prototype.hasOwnProperty,$0=Object.prototype.propertyIsEnumerable,ca=(t,e,r)=>e in t?M0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ua=(t,e)=>{for(var r in e||(e={}))j0.call(e,r)&&ca(t,r,e[r]);if(aa)for(var r of aa(e))$0.call(e,r)&&ca(t,r,e[r]);return t};class fa extends ju{constructor(e,r,n,i=vt,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,this.map=new Map,this.version=Oo,this.cached=[],this.initialized=!1,this.storagePrefix=vt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(c=>{this.getKey&&c!==null&&!jr(c)?this.map.set(this.getKey(c),c):Id(c)?this.map.set(c.id,c):Rd(c)&&this.map.set(c.topic,c)}),this.cached=[],this.initialized=!0)},this.set=async(c,u)=>{this.isInitialized(),this.map.has(c)?await this.update(c,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:c,value:u}),this.map.set(c,u),await this.persist())},this.get=c=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:c}),this.getData(c)),this.getAll=c=>(this.isInitialized(),c?this.values.filter(u=>Object.keys(c).every(h=>U0(u[h],c[h]))):this.values),this.update=async(c,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:c,update:u});const h=ua(ua({},this.getData(c)),u);this.map.set(c,h),await this.persist()},this.delete=async(c,u)=>{this.isInitialized(),this.map.has(c)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:c,reason:u}),this.map.delete(c),await this.persist())},this.logger=Se.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ha{constructor(e,r){this.core=e,this.logger=r,this.name=Co,this.version=Ao,this.events=new ut.exports,this.initialized=!1,this.storagePrefix=vt,this.ignoredPayloadTypes=[Vt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Fn(),i=await this.core.crypto.setSymKey(n),s=Hn(ce.FIVE_MINUTES),c={protocol:bo},u={topic:i,expiry:s,relay:c,active:!1},h=Dd({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:c});return await this.pairings.set(i,u),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:h}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:c}=Ed(n.uri);if(this.pairings.keys.includes(i))throw new Error(`Pairing already exists: ${i}`);if(this.core.crypto.hasKeys(i))throw new Error(`Keychain already exists: ${i}`);const u=Hn(ce.FIVE_MINUTES),h={topic:i,relay:c,expiry:u,active:!1};return await this.pairings.set(i,h),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:c}),this.core.expirer.set(i,u),n.activatePairing&&await this.activate({topic:i}),h},this.activate=async({topic:n})=>{this.isInitialized();const i=Hn(ce.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:c,resolve:u,reject:h}=fd();this.events.once(Kn("pairing_ping",s),({error:f})=>{f?h(f):u()}),await c()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",dr("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const c=ei(i,s),u=await this.core.crypto.encode(n,c),h=Wt[i].req;return this.core.history.set(n,c),this.core.relayer.publish(n,u,h),c.id},this.sendResult=async(n,i,s)=>{const c=Yo(n,s),u=await this.core.crypto.encode(i,c),h=await this.core.history.get(i,n),f=Wt[h.request.method].res;await this.core.relayer.publish(i,u,f),await this.core.history.resolve(c)},this.sendError=async(n,i,s)=>{const c=Xo(n,s),u=await this.core.crypto.encode(i,c),h=await this.core.history.get(i,n),f=Wt[h.request.method]?Wt[h.request.method].res:Wt.unregistered_method.res;await this.core.relayer.publish(i,u,f),await this.core.history.resolve(c)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,dr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>ro(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n,c=s.method;if(this.pairings.keys.includes(i))switch(c){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,c=(await this.core.history.get(i,s.id)).request.method;if(this.pairings.keys.includes(i))switch(c){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(c)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{Qo(i)?this.events.emit(Kn("pairing_ping",s),{}):Br(i)&&this.events.emit(Kn("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:c}=i;try{if(this.registeredMethods.includes(c))return;const u=dr("WC_METHOD_UNSUPPORTED",c);await this.sendError(s,n,u),this.logger.error(u)}catch(u){await this.sendError(s,n,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(dr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!Vn(n)){const{message:i}=xe("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!xd(n.uri)){const{message:i}=xe("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!Vn(n)){const{message:s}=xe("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!Vn(n)){const{message:s}=xe("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!so(n,!1)){const{message:i}=xe("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=xe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(ro(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=xe("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.pairings=new fa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(ze.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);Zo(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):ti(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(ft.expired,async e=>{const{topic:r}=dd(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class la extends Lu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ut.exports.EventEmitter,this.name=Po,this.version=Lo,this.cached=[],this.initialized=!1,this.storagePrefix=vt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const c={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(c.id,c),this.events.emit(gt.created,c)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=Br(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(gt.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(gt.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:ei(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(gt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(gt.created,e=>{const r=gt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(gt.updated,e=>{const r=gt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(gt.deleted,e=>{const r=gt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class da extends Fu{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ut.exports.EventEmitter,this.name=No,this.version=Uo,this.cached=[],this.initialized=!1,this.storagePrefix=vt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),c={target:s,expiry:i};this.expirations.set(s,c),this.checkExpiry(s,c),this.events.emit(ft.created,{target:s,expiration:c})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(ft.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return hd(e);if(typeof e=="number")return ld(e);const{message:r}=xe("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ft.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=xe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=xe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;ce.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(ft.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(er.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(ft.created,e=>{const r=ft.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ft.expired,e=>{const r=ft.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ft.deleted,e=>{const r=ft.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=xe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ga extends Bu{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=Fr,this.initialized=!1,this.init=async n=>{Js()||!Zs()||(this.verifyUrl=n?.verifyUrl||Xn,await this.createIframe())},this.register=async n=>{var i;if(this.initialized||await this.init(),!!this.iframe)try{(i=this.iframe.contentWindow)==null||i.postMessage(n.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${n.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async n=>{var i;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${n.attestationId}`);const s=this.startAbortTimer(ce.FIVE_SECONDS),c=await fetch(`${this.verifyUrl}/attestation/${n.attestationId}`,{signal:this.abortController.signal});return clearTimeout(s),c.status===200?(i=await c.json())==null?void 0:i.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((n,i)=>{if(document.getElementById(Fr))return n();const s=document.createElement("iframe");s.setAttribute("id",Fr),s.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),s.style.display="none",s.addEventListener("load",()=>{this.initialized=!0,n()}),s.addEventListener("error",c=>{i(c)}),document.body.append(s),this.iframe=s}),new Promise(n=>{setTimeout(()=>n("iframe load timeout"),ce.toMiliseconds(ce.ONE_SECOND/2))})])}catch(n){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(n)}},this.logger=Se.generateChildLogger(r,this.name),this.verifyUrl=Xn,this.abortController=new AbortController,this.isDevEnv=zn()&&process.env.IS_VITEST}get context(){return Se.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),ce.toMiliseconds(e))}}var F0=Object.defineProperty,_a=Object.getOwnPropertySymbols,B0=Object.prototype.hasOwnProperty,z0=Object.prototype.propertyIsEnumerable,ya=(t,e,r)=>e in t?F0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,pa=(t,e)=>{for(var r in e||(e={}))B0.call(e,r)&&ya(t,r,e[r]);if(_a)for(var r of _a(e))z0.call(e,r)&&ya(t,r,e[r]);return t};class zr extends Pu{constructor(e){super(e),this.protocol=qn,this.version=oo,this.name=$r,this.events=new ut.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Yn;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Se.pino(Se.getDefaultLoggerOptions({level:e?.logger||ao.logger}));this.logger=Se.generateChildLogger(r,this.name),this.heartbeat=new er.HeartBeat,this.crypto=new jo(this,this.logger,e?.keychain),this.history=new la(this,this.logger),this.expirer=new da(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new cc(pa(pa({},co),e?.storageOptions)),this.relayer=new oa({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new ha(this,this.logger),this.verify=new ga(this.projectId||"",this.logger)}static async init(e){const r=new zr(e);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(To,n),r}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const H0=zr;k.CORE_CONTEXT=$r,k.CORE_DEFAULT=ao,k.CORE_PROTOCOL=qn,k.CORE_STORAGE_OPTIONS=co,k.CORE_STORAGE_PREFIX=vt,k.CORE_VERSION=oo,k.CRYPTO_CLIENT_SEED=Wn,k.CRYPTO_CONTEXT=uo,k.CRYPTO_JWT_TTL=fo,k.Core=H0,k.Crypto=jo,k.EXPIRER_CONTEXT=No,k.EXPIRER_DEFAULT_TTL=Ld,k.EXPIRER_EVENTS=ft,k.EXPIRER_STORAGE_VERSION=Uo,k.Expirer=da,k.HISTORY_CONTEXT=Po,k.HISTORY_EVENTS=gt,k.HISTORY_STORAGE_VERSION=Lo,k.JsonRpcHistory=la,k.KEYCHAIN_CONTEXT=ho,k.KEYCHAIN_STORAGE_VERSION=lo,k.KeyChain=Mo,k.MESSAGES_CONTEXT=go,k.MESSAGES_STORAGE_VERSION=_o,k.MessageTracker=$o,k.PAIRING_CONTEXT=Co,k.PAIRING_DEFAULT_TTL=Pd,k.PAIRING_RPC_OPTS=Wt,k.PAIRING_STORAGE_VERSION=Ao,k.PENDING_SUB_RESOLUTION_TIMEOUT=Ro,k.PUBLISHER_CONTEXT=po,k.PUBLISHER_DEFAULT_TTL=yo,k.Pairing=ha,k.RELAYER_CONTEXT=Eo,k.RELAYER_DEFAULT_LOGGER=vo,k.RELAYER_DEFAULT_PROTOCOL=bo,k.RELAYER_DEFAULT_RELAY_URL=Yn,k.RELAYER_EVENTS=ze,k.RELAYER_PROVIDER_EVENTS=qt,k.RELAYER_RECONNECT_TIMEOUT=mo,k.RELAYER_SDK_VERSION=Do,k.RELAYER_STORAGE_OPTIONS=Cd,k.RELAYER_SUBSCRIBER_SUFFIX=wo,k.RELAYER_TRANSPORT_CUTOFF=So,k.Relayer=oa,k.STORE_STORAGE_VERSION=Oo,k.SUBSCRIBER_CONTEXT=xo,k.SUBSCRIBER_DEFAULT_TTL=Ad,k.SUBSCRIBER_EVENTS=dt,k.SUBSCRIBER_STORAGE_VERSION=Io,k.Store=fa,k.Subscriber=na,k.VERIFY_CONTEXT=Fr,k.VERIFY_SERVER=Xn,k.Verify=ga,k.WALLETCONNECT_CLIENT_ID=To,k.default=zr,Object.defineProperty(k,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
